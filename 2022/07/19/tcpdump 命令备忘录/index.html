<!DOCTYPE html><html lang="cn"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="robots" content="index, follow"><title>tcpdump 命令备忘录 • Webb</title><meta name="description" content="tcpdump 命令备忘录 - Webb"><link rel="icon" href="/57182600.jpeg"><link rel="stylesheet" href="https://unpkg.com/nanoreset@3.0.1/nanoreset.min.css"><link rel="stylesheet" href="/css/theme.css"><link rel="search" type="application/opensearchdescription+xml" href="/atom.xml" title="Webb"><meta name="generator" content="Hexo 6.2.0"><link rel="alternate" href="/atom.xml" title="Webb" type="application/atom+xml">
</head><body><div class="wrap" id="barba-wrapper"><header><h1 class="branding"><a href="/" title="Webb"><img class="logo-image" src="/57182600.jpeg" alt="logo"></a></h1><ul class="nav nav-list"><li class="nav-list-item"><a class="nav-list-link no-barba" href="/" target="_self">主页</a></li><li class="nav-list-item"><a class="nav-list-link no-barba" href="/about" target="_self">关于</a></li><li class="nav-list-item"><a class="nav-list-link no-barba" href="/works" target="_self">作品</a></li><li class="nav-list-item"><a class="nav-list-link no-barba" href="/archives" target="_self">档案</a></li><li class="nav-list-item"></ul></header><div class="barba-container"><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">tcpdump 命令备忘录</h1><div class="post-info"><a></a>2022-07-19</div><div class="post-content"><h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p>Tcpdump 打印出网络接口上数据包内容的描述。</p>
<h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">tcpdump [options] [proto] [<span class="built_in">dir</span>] [<span class="built_in">type</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># options</span></span><br><span class="line">[-aAbdDefhHIJKlLnNOpqStuUvxX<span class="comment">#] [ -B size ] [ -c count ]</span></span><br><span class="line">[ -C file_size ] [ -E algo:secret ] [ -F file ] [ -G seconds ]</span><br><span class="line">[ -i interface ] [ -j tstamptype ] [ -M secret ] [ --number ]</span><br><span class="line">[ -Q <span class="keyword">in</span>|out|inout ]</span><br><span class="line">[ -r file ] [ -s snaplen ] [ --time-stamp-precision precision ]</span><br><span class="line">[ --immediate-mode ] [ -T <span class="built_in">type</span> ] [ --version ] [ -V file ]</span><br><span class="line">[ -w file ] [ -W filecount ] [ -y datalinktype ] [ -z postrotate-command ]</span><br><span class="line">[ -Z user ] [ expression ]</span><br><span class="line"></span><br><span class="line"><span class="comment"># proto</span></span><br><span class="line">tcp udp icmp</span><br><span class="line">ip ipv6</span><br><span class="line">arp rarp</span><br><span class="line">ether wlan</span><br><span class="line"></span><br><span class="line"><span class="comment"># dir</span></span><br><span class="line">src dst</span><br><span class="line"></span><br><span class="line"><span class="comment"># type</span></span><br><span class="line">host net port portrange</span><br></pre></td></tr></table></figure>

<h3 id="简单使用"><a href="#简单使用" class="headerlink" title="简单使用"></a>简单使用</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">root@webb:~<span class="comment"># tcpdump </span></span><br><span class="line">tcpdump: verbose output suppressed, use -v or -vv <span class="keyword">for</span> full protocol decode</span><br><span class="line">listening on ens32, link-type EN10MB (Ethernet), capture size 262144 bytes</span><br><span class="line">15:01:20.103144 IP webb.ssh &gt; 192.168.111.1.43116: Flags [P.], <span class="built_in">seq</span> 999682989:999683185, ack 3034309012, win 501, options [nop,nop,TS val 3742754932 ecr 544450561], length 196</span><br><span class="line">15:01:20.103268 IP 192.168.111.1.43116 &gt; webb.ssh: Flags [.], ack 196, win 501, options [nop,nop,TS val 544450627 ecr 3742754932], length 0</span><br><span class="line">...</span><br><span class="line">15:01:20.620795 IP 192.168.111.1.43116 &gt; webb.ssh: Flags [.], ack 364648, win 998, options [nop,nop,TS val 544451144 ecr 3742755450], length 0</span><br><span class="line">15:01:20.620861 IP webb.ssh &gt; 192.168.111.1.43116: Flags [P.], <span class="built_in">seq</span> 364648:365132, ack 1, win 501, options [nop,nop,TS val 3742755450 ecr 544451144], length 484</span><br><span class="line">15:01:20.621140 IP 192.168.111.1.43116 &gt; webb.ssh: Flags [P.], <span class="built_in">seq</span> 1:37, ack 364648, win 998, options [nop,nop,TS val 544451144 ecr 3742755450], length 36</span><br><span class="line">2079 packets captured</span><br><span class="line">2079 packets received by filter</span><br><span class="line">0 packets dropped by kernel</span><br></pre></td></tr></table></figure>

<p>解析信息。</p>
<table>
<thead>
<tr>
<th>时:分:秒.毫秒</th>
<th>网络协议</th>
<th>发送方的IP地址.端口&#x2F;主机名.协议（如果这里的端口能够对应上协议的端口就显示协议）&gt; 接收方IP地址.端口&#x2F;主机名.协议</th>
<th align="left"></th>
<th>协议的信息</th>
</tr>
</thead>
<tbody><tr>
<td>15:01:20.621140</td>
<td>IP</td>
<td>192.168.111.1.43116 &gt; webb.ssh</td>
<td align="left"></td>
<td>Flags [P.], seq 1:37, ack 364648, win 998, options [nop,nop,TS val 544451144 ecr 3742755450], length 36</td>
</tr>
</tbody></table>
<h2 id="过滤使用"><a href="#过滤使用" class="headerlink" title="过滤使用"></a>过滤使用</h2><h3 id="过滤特定IP地址数据包"><a href="#过滤特定IP地址数据包" class="headerlink" title="过滤特定IP地址数据包"></a>过滤特定IP地址数据包</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">root@webb:~<span class="comment"># tcpdump host 192.168.1.1</span></span><br><span class="line">tcpdump: verbose output suppressed, use -v or -vv <span class="keyword">for</span> full protocol decode</span><br><span class="line">listening on ens32, link-type EN10MB (Ethernet), capture size 262144 bytes</span><br><span class="line">15:34:03.881935 IP webb &gt; gw.gcableconfig.local: ICMP <span class="built_in">echo</span> request, <span class="built_in">id</span> 4, <span class="built_in">seq</span> 1, length 64</span><br><span class="line">15:34:03.884549 IP gw.gcableconfig.local &gt; webb: ICMP <span class="built_in">echo</span> reply, <span class="built_in">id</span> 4, <span class="built_in">seq</span> 1, length 64</span><br><span class="line">15:34:04.883253 IP webb &gt; gw.gcableconfig.local: ICMP <span class="built_in">echo</span> request, <span class="built_in">id</span> 4, <span class="built_in">seq</span> 2, length 64</span><br><span class="line">15:34:04.884774 IP gw.gcableconfig.local &gt; webb: ICMP <span class="built_in">echo</span> reply, <span class="built_in">id</span> 4, <span class="built_in">seq</span> 2, length 64</span><br><span class="line">15:34:05.892408 IP webb &gt; gw.gcableconfig.local: ICMP <span class="built_in">echo</span> request, <span class="built_in">id</span> 4, <span class="built_in">seq</span> 3, length 64</span><br><span class="line">15:34:05.921905 IP gw.gcableconfig.local &gt; webb: ICMP <span class="built_in">echo</span> reply, <span class="built_in">id</span> 4, <span class="built_in">seq</span> 3, length 64</span><br><span class="line">15:34:06.913191 IP webb &gt; gw.gcableconfig.local: ICMP <span class="built_in">echo</span> request, <span class="built_in">id</span> 4, <span class="built_in">seq</span> 4, length 64</span><br><span class="line">15:34:06.920496 IP gw.gcableconfig.local &gt; webb: ICMP <span class="built_in">echo</span> reply, <span class="built_in">id</span> 4, <span class="built_in">seq</span> 4, length 64</span><br><span class="line">8 packets captured</span><br><span class="line">10 packets received by filter</span><br><span class="line">0 packets dropped by kernel</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="过滤发送方IP地址数据包"><a href="#过滤发送方IP地址数据包" class="headerlink" title="过滤发送方IP地址数据包"></a>过滤发送方IP地址数据包</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">root@webb:~<span class="comment"># tcpdump src 192.168.1.1</span></span><br><span class="line">tcpdump: verbose output suppressed, use -v or -vv <span class="keyword">for</span> full protocol decode</span><br><span class="line">listening on ens32, link-type EN10MB (Ethernet), capture size 262144 bytes</span><br><span class="line">15:40:51.123117 IP gw.gcableconfig.local &gt; webb: ICMP <span class="built_in">echo</span> reply, <span class="built_in">id</span> 7, <span class="built_in">seq</span> 1, length 64</span><br><span class="line">15:40:52.125865 IP gw.gcableconfig.local &gt; webb: ICMP <span class="built_in">echo</span> reply, <span class="built_in">id</span> 7, <span class="built_in">seq</span> 2, length 64</span><br><span class="line">15:40:53.127900 IP gw.gcableconfig.local &gt; webb: ICMP <span class="built_in">echo</span> reply, <span class="built_in">id</span> 7, <span class="built_in">seq</span> 3, length 64</span><br><span class="line">3 packets captured</span><br><span class="line">3 packets received by filter</span><br><span class="line">0 packets dropped by kernel</span><br></pre></td></tr></table></figure>

<h3 id="过滤接收方IP地址数据包"><a href="#过滤接收方IP地址数据包" class="headerlink" title="过滤接收方IP地址数据包"></a>过滤接收方IP地址数据包</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">root@webb:~<span class="comment"># tcpdump dst 192.168.1.1</span></span><br><span class="line">tcpdump: verbose output suppressed, use -v or -vv <span class="keyword">for</span> full protocol decode</span><br><span class="line">listening on ens32, link-type EN10MB (Ethernet), capture size 262144 bytes</span><br><span class="line">15:36:04.468257 IP webb &gt; gw.gcableconfig.local: ICMP <span class="built_in">echo</span> request, <span class="built_in">id</span> 5, <span class="built_in">seq</span> 1, length 64</span><br><span class="line">15:36:05.469379 IP webb &gt; gw.gcableconfig.local: ICMP <span class="built_in">echo</span> request, <span class="built_in">id</span> 5, <span class="built_in">seq</span> 2, length 64</span><br><span class="line">15:36:06.471280 IP webb &gt; gw.gcableconfig.local: ICMP <span class="built_in">echo</span> request, <span class="built_in">id</span> 5, <span class="built_in">seq</span> 3, length 64</span><br><span class="line">3 packets captured</span><br><span class="line">3 packets received by filter</span><br><span class="line">0 packets dropped by kernel</span><br></pre></td></tr></table></figure>

<h3 id="过滤某个网段数据包"><a href="#过滤某个网段数据包" class="headerlink" title="过滤某个网段数据包"></a>过滤某个网段数据包</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">root@webb:~<span class="comment"># tcpdump net 192.168.1.0/24</span></span><br><span class="line">tcpdump: verbose output suppressed, use -v or -vv <span class="keyword">for</span> full protocol decode</span><br><span class="line">listening on ens32, link-type EN10MB (Ethernet), capture size 262144 bytes</span><br><span class="line">15:43:20.125194 IP webb &gt; gw.gcableconfig.local: ICMP <span class="built_in">echo</span> request, <span class="built_in">id</span> 8, <span class="built_in">seq</span> 1, length 64</span><br><span class="line">15:43:20.127335 IP gw.gcableconfig.local &gt; webb: ICMP <span class="built_in">echo</span> reply, <span class="built_in">id</span> 8, <span class="built_in">seq</span> 1, length 64</span><br><span class="line">15:43:21.147335 IP webb &gt; gw.gcableconfig.local: ICMP <span class="built_in">echo</span> request, <span class="built_in">id</span> 8, <span class="built_in">seq</span> 2, length 64</span><br><span class="line">15:43:21.149613 IP gw.gcableconfig.local &gt; webb: ICMP <span class="built_in">echo</span> reply, <span class="built_in">id</span> 8, <span class="built_in">seq</span> 2, length 64</span><br><span class="line">15:43:22.128009 IP webb &gt; gw.gcableconfig.local: ICMP <span class="built_in">echo</span> request, <span class="built_in">id</span> 8, <span class="built_in">seq</span> 3, length 64</span><br><span class="line">15:43:22.130053 IP gw.gcableconfig.local &gt; webb: ICMP <span class="built_in">echo</span> reply, <span class="built_in">id</span> 8, <span class="built_in">seq</span> 3, length 64</span><br><span class="line">15:43:24.042801 IP webb &gt; android-0000000000: ICMP <span class="built_in">echo</span> request, <span class="built_in">id</span> 9, <span class="built_in">seq</span> 1, length 64</span><br><span class="line">...</span><br><span class="line">15:43:27.629869 IP webb &gt; 192.168.1.3: ICMP <span class="built_in">echo</span> request, <span class="built_in">id</span> 10, <span class="built_in">seq</span> 1, length 64</span><br><span class="line">15:43:28.648935 IP webb &gt; 192.168.1.3: ICMP <span class="built_in">echo</span> request, <span class="built_in">id</span> 10, <span class="built_in">seq</span> 2, length 64</span><br><span class="line">15:43:29.673008 IP webb &gt; 192.168.1.3: ICMP <span class="built_in">echo</span> request, <span class="built_in">id</span> 10, <span class="built_in">seq</span> 3, length 64</span><br><span class="line">15:43:30.696968 IP webb &gt; 192.168.1.3: ICMP <span class="built_in">echo</span> request, <span class="built_in">id</span> 10, <span class="built_in">seq</span> 4, length 64</span><br><span class="line">15:43:30.698285 IP 192.168.1.68 &gt; webb: ICMP host 192.168.1.3 unreachable, length 92</span><br><span class="line">15:43:30.698285 IP 192.168.1.68 &gt; webb: ICMP host 192.168.1.3 unreachable, length 92</span><br><span class="line">15:43:30.698285 IP 192.168.1.68 &gt; webb: ICMP host 192.168.1.3 unreachable, length 92</span><br><span class="line">15:43:30.698285 IP 192.168.1.68 &gt; webb: ICMP host 192.168.1.3 unreachable, length 92</span><br><span class="line">20 packets captured</span><br><span class="line">20 packets received by filter</span><br><span class="line">0 packets dropped by kernel</span><br></pre></td></tr></table></figure>

<h3 id="过滤某个端口或某个范围端口数据包"><a href="#过滤某个端口或某个范围端口数据包" class="headerlink" title="过滤某个端口或某个范围端口数据包"></a>过滤某个端口或某个范围端口数据包</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">root@webb:~<span class="comment"># tcpdump port 80 / tcpdump port http / tcpdump portrange 8080-8888</span></span><br><span class="line">tcpdump: verbose output suppressed, use -v or -vv <span class="keyword">for</span> full protocol decode</span><br><span class="line">listening on ens32, link-type EN10MB (Ethernet), capture size 262144 bytes</span><br><span class="line">...</span><br><span class="line">15:51:32.684946 IP webb.56630 &gt; gw.gcableconfig.local.http: Flags [.], ack 1, win 64240, length 0</span><br><span class="line">15:51:32.685142 IP webb.56630 &gt; gw.gcableconfig.local.http: Flags [P.], <span class="built_in">seq</span> 1:76, ack 1, win 64240, length 75: HTTP: GET / HTTP/1.1</span><br><span class="line">15:51:32.685408 IP gw.gcableconfig.local.http &gt; webb.56630: Flags [.], ack 76, win 64240, length 0</span><br><span class="line">15:51:32.688526 IP gw.gcableconfig.local.http &gt; webb.56630: Flags [P.], <span class="built_in">seq</span> 1:2897, ack 76, win 64240, length 2896: HTTP: HTTP/1.0 200 OK</span><br><span class="line">15:51:32.688618 IP webb.56630 &gt; gw.gcableconfig.local.http: Flags [.], ack 2897, win 62780, length 0</span><br><span class="line">15:51:32.696002 IP gw.gcableconfig.local.http &gt; webb.56630: Flags [FP.], <span class="built_in">seq</span> 2897:5303, ack 76, win 64240, length 2406: HTTP</span><br><span class="line">...</span><br><span class="line">17 packets captured</span><br><span class="line">17 packets received by filter</span><br><span class="line">0 packets dropped by kernel</span><br></pre></td></tr></table></figure>

<h3 id="过滤某个协议数据包"><a href="#过滤某个协议数据包" class="headerlink" title="过滤某个协议数据包"></a>过滤某个协议数据包</h3><p>不能过滤应用层协议。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">root@webb:~<span class="comment"># tcpdump icmp</span></span><br><span class="line">tcpdump: verbose output suppressed, use -v or -vv <span class="keyword">for</span> full protocol decode</span><br><span class="line">listening on ens32, link-type EN10MB (Ethernet), capture size 262144 bytes</span><br><span class="line">15:59:40.866349 IP webb &gt; gw.gcableconfig.local: ICMP <span class="built_in">echo</span> request, <span class="built_in">id</span> 12, <span class="built_in">seq</span> 1, length 64</span><br><span class="line">15:59:40.884372 IP gw.gcableconfig.local &gt; webb: ICMP <span class="built_in">echo</span> reply, <span class="built_in">id</span> 12, <span class="built_in">seq</span> 1, length 64</span><br><span class="line">15:59:41.868101 IP webb &gt; gw.gcableconfig.local: ICMP <span class="built_in">echo</span> request, <span class="built_in">id</span> 12, <span class="built_in">seq</span> 2, length 64</span><br><span class="line">15:59:41.870006 IP gw.gcableconfig.local &gt; webb: ICMP <span class="built_in">echo</span> reply, <span class="built_in">id</span> 12, <span class="built_in">seq</span> 2, length 64</span><br><span class="line">15:59:42.868916 IP webb &gt; gw.gcableconfig.local: ICMP <span class="built_in">echo</span> request, <span class="built_in">id</span> 12, <span class="built_in">seq</span> 3, length 64</span><br><span class="line">15:59:42.874483 IP gw.gcableconfig.local &gt; webb: ICMP <span class="built_in">echo</span> reply, <span class="built_in">id</span> 12, <span class="built_in">seq</span> 3, length 64</span><br><span class="line">6 packets captured</span><br><span class="line">6 packets received by filter</span><br><span class="line">0 packets dropped by kernel</span><br></pre></td></tr></table></figure>

<h2 id="常见参数"><a href="#常见参数" class="headerlink" title="常见参数"></a>常见参数</h2><h3 id="i-监听网卡"><a href="#i-监听网卡" class="headerlink" title="-i 监听网卡"></a>-i 监听网卡</h3><table>
<thead>
<tr>
<th>用法</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>-i ens32</td>
<td>监听某块网卡</td>
</tr>
<tr>
<td>-i any</td>
<td>监听所有网卡</td>
</tr>
</tbody></table>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">root@webb:~<span class="comment"># tcpdump -i ens32</span></span><br><span class="line">tcpdump: verbose output suppressed, use -v or -vv <span class="keyword">for</span> full protocol decode</span><br><span class="line">listening on ens32, link-type EN10MB (Ethernet), capture size 262144 bytes</span><br><span class="line">16:05:23.250173 IP webb.ssh &gt; 192.168.111.1.43116: Flags [P.], <span class="built_in">seq</span> 1004681477:1004681593, ack 3034329096, win 501, options [nop,nop,TS val 3746598079 ecr 548293704], length 116</span><br><span class="line">16:05:23.250277 IP 192.168.111.1.43116 &gt; webb.ssh: Flags [.], ack 116, win 1056, options [nop,nop,TS val 548293754 ecr 3746598079], length 0</span><br><span class="line">16:05:23.250300 IP webb.ssh &gt; 192.168.111.1.43116: Flags [P.], <span class="built_in">seq</span> 116:152, ack 1, win 501, options [nop,nop,TS val 3746598080 ecr 548293704], length 36</span><br><span class="line">...</span><br><span class="line">7884 packets captured</span><br><span class="line">8045 packets received by filter</span><br><span class="line">161 packets dropped by kernel</span><br></pre></td></tr></table></figure>

<h3 id="w-将捕获的数据包保存到文件"><a href="#w-将捕获的数据包保存到文件" class="headerlink" title="-w 将捕获的数据包保存到文件"></a>-w 将捕获的数据包保存到文件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">root@webb:~<span class="comment"># tcpdump -w filename.pcap</span></span><br><span class="line">tcpdump: listening on ens32, link-type EN10MB (Ethernet), capture size 262144 bytes</span><br><span class="line">6 packets captured</span><br><span class="line">6 packets received by filter</span><br><span class="line">0 packets dropped by kernel</span><br><span class="line"></span><br><span class="line">root@webb:~<span class="comment"># file filename.pcap </span></span><br><span class="line">filename.pcap: pcap capture file, microsecond ts (little-endian) - version 2.4 (Ethernet, capture length 262144)</span><br><span class="line"></span><br><span class="line">root@webb:~<span class="comment"># ls -lh filename.pcap</span></span><br><span class="line">-rw-r--r-- 1 tcpdump tcpdump 708 Jul 19 16:11 filename.pcap</span><br></pre></td></tr></table></figure>

<h3 id="r-从文件中读取数据包"><a href="#r-从文件中读取数据包" class="headerlink" title="-r 从文件中读取数据包"></a>-r 从文件中读取数据包</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">root@webb:~<span class="comment"># tcpdump -r filename.pcap </span></span><br><span class="line">reading from file filename.pcap, link-type EN10MB (Ethernet)</span><br><span class="line">16:11:35.279466 IP webb &gt; gw.gcableconfig.local: ICMP <span class="built_in">echo</span> request, <span class="built_in">id</span> 13, <span class="built_in">seq</span> 1, length 64</span><br><span class="line">16:11:35.281550 IP gw.gcableconfig.local &gt; webb: ICMP <span class="built_in">echo</span> reply, <span class="built_in">id</span> 13, <span class="built_in">seq</span> 1, length 64</span><br><span class="line">16:11:36.302235 IP webb &gt; gw.gcableconfig.local: ICMP <span class="built_in">echo</span> request, <span class="built_in">id</span> 13, <span class="built_in">seq</span> 2, length 64</span><br><span class="line">16:11:36.330271 IP gw.gcableconfig.local &gt; webb: ICMP <span class="built_in">echo</span> reply, <span class="built_in">id</span> 13, <span class="built_in">seq</span> 2, length 64</span><br><span class="line">16:11:37.296484 IP webb &gt; gw.gcableconfig.local: ICMP <span class="built_in">echo</span> request, <span class="built_in">id</span> 13, <span class="built_in">seq</span> 3, length 64</span><br><span class="line">16:11:37.299137 IP gw.gcableconfig.local &gt; webb: ICMP <span class="built_in">echo</span> reply, <span class="built_in">id</span> 13, <span class="built_in">seq</span> 3, length 64</span><br></pre></td></tr></table></figure>

<h3 id="n-不把IP地址转化为主机名，直接显示IP地址。"><a href="#n-不把IP地址转化为主机名，直接显示IP地址。" class="headerlink" title="-n 不把IP地址转化为主机名，直接显示IP地址。"></a>-n 不把IP地址转化为主机名，直接显示IP地址。</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">root@webb:~<span class="comment"># tcpdump -n</span></span><br><span class="line">tcpdump: verbose output suppressed, use -v or -vv <span class="keyword">for</span> full protocol decode</span><br><span class="line">listening on ens32, link-type EN10MB (Ethernet), capture size 262144 bytes</span><br><span class="line">16:17:49.617171 IP 192.168.111.129 &gt; 192.168.1.1: ICMP <span class="built_in">echo</span> request, <span class="built_in">id</span> 14, <span class="built_in">seq</span> 1, length 64</span><br><span class="line">16:17:49.619181 IP 192.168.1.1 &gt; 192.168.111.129: ICMP <span class="built_in">echo</span> reply, <span class="built_in">id</span> 14, <span class="built_in">seq</span> 1, length 64</span><br><span class="line">16:17:50.703854 IP 192.168.111.129 &gt; 192.168.1.1: ICMP <span class="built_in">echo</span> request, <span class="built_in">id</span> 14, <span class="built_in">seq</span> 2, length 64</span><br><span class="line">16:17:50.734139 IP 192.168.1.1 &gt; 192.168.111.129: ICMP <span class="built_in">echo</span> reply, <span class="built_in">id</span> 14, <span class="built_in">seq</span> 2, length 64</span><br><span class="line">16:17:51.679695 IP 192.168.111.129 &gt; 192.168.1.1: ICMP <span class="built_in">echo</span> request, <span class="built_in">id</span> 14, <span class="built_in">seq</span> 3, length 64</span><br><span class="line">16:17:51.690580 IP 192.168.1.1 &gt; 192.168.111.129: ICMP <span class="built_in">echo</span> reply, <span class="built_in">id</span> 14, <span class="built_in">seq</span> 3, length 64</span><br><span class="line">6 packets captured</span><br><span class="line">6 packets received by filter</span><br><span class="line">0 packets dropped by kernel</span><br></pre></td></tr></table></figure>

<h3 id="nn-不把IP地址转化为主机名和不把端口号转换成协议，直接显示IP地址和端口号。"><a href="#nn-不把IP地址转化为主机名和不把端口号转换成协议，直接显示IP地址和端口号。" class="headerlink" title="-nn 不把IP地址转化为主机名和不把端口号转换成协议，直接显示IP地址和端口号。"></a>-nn 不把IP地址转化为主机名和不把端口号转换成协议，直接显示IP地址和端口号。</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">root@webb:~<span class="comment"># tcpdump -nn</span></span><br><span class="line">tcpdump: verbose output suppressed, use -v or -vv <span class="keyword">for</span> full protocol decode</span><br><span class="line">listening on ens32, link-type EN10MB (Ethernet), capture size 262144 bytes</span><br><span class="line">16:20:44.830171 IP 192.168.111.129.22 &gt; 192.168.111.1.43116: Flags [P.], <span class="built_in">seq</span> 1006131257:1006131453, ack 3034339648, win 501, options [nop,nop,TS val 3747519659 ecr 549215216], length 196</span><br><span class="line">16:20:44.830292 IP 192.168.111.1.43116 &gt; 192.168.111.129.22: Flags [.], ack 196, win 1056, options [nop,nop,TS val 549215281 ecr 3747519659], length 0</span><br><span class="line">16:20:44.830478 IP 192.168.111.129.22 &gt; 192.168.111.1.43116: Flags [P.], <span class="built_in">seq</span> 196:584, ack 1, win 501, options [nop,nop,TS val 3747519660 ecr 549215281], length 388</span><br><span class="line">16:20:44.830627 IP 192.168.111.1.43116 &gt; 192.168.111.129.22: Flags [.], ack 584, win 1056, options [nop,nop,TS val 549215281 ecr 3747519660], length 0</span><br><span class="line">...</span><br><span class="line">2550 packets captured</span><br><span class="line">2552 packets received by filter</span><br><span class="line">0 packets dropped by kernel</span><br></pre></td></tr></table></figure>

<h3 id="N-只显示host或域名开头部分（192-ssh-x3D-192-168-1-1-ssh）。"><a href="#N-只显示host或域名开头部分（192-ssh-x3D-192-168-1-1-ssh）。" class="headerlink" title="-N 只显示host或域名开头部分（192.ssh&#x3D;192.168.1.1.ssh）。"></a>-N 只显示host或域名开头部分（192.ssh&#x3D;192.168.1.1.ssh）。</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">root@webb:~<span class="comment"># tcpdump -N</span></span><br><span class="line">tcpdump: verbose output suppressed, use -v or -vv <span class="keyword">for</span> full protocol decode</span><br><span class="line">listening on ens32, link-type EN10MB (Ethernet), capture size 262144 bytes</span><br><span class="line">16:23:15.312084 IP webb.ssh &gt; 192.168.111.1.43116: Flags [P.], <span class="built_in">seq</span> 1006622321:1006622437, ack 3034339996, win 501, options [nop,nop,TS val 3747670141 ecr 549365686], length 116</span><br><span class="line">16:23:15.312187 IP 192.168.111.1.43116 &gt; webb.ssh: Flags [.], ack 116, win 3446, options [nop,nop,TS val 549365757 ecr 3747670141], length 0</span><br><span class="line">16:23:15.312200 IP webb.ssh &gt; 192.168.111.1.43116: Flags [P.], <span class="built_in">seq</span> 116:152, ack 1, win 501, options [nop,nop,TS val 3747670142 ecr 549365686], length 36</span><br><span class="line">16:23:15.312258 IP 192.168.111.1.43116 &gt; webb.ssh: Flags [.], ack 152, win 3446, options [nop,nop,TS val 549365757 ecr 3747670142], length 0</span><br><span class="line">...</span><br><span class="line">658 packets captured</span><br><span class="line">825 packets received by filter</span><br><span class="line">161 packets dropped by kernel</span><br></pre></td></tr></table></figure>

<h3 id="t-每行不输出时间"><a href="#t-每行不输出时间" class="headerlink" title="-t 每行不输出时间"></a>-t 每行不输出时间</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">root@webb:~<span class="comment"># tcpdump -t</span></span><br><span class="line">tcpdump: verbose output suppressed, use -v or -vv <span class="keyword">for</span> full protocol decode</span><br><span class="line">listening on ens32, link-type EN10MB (Ethernet), capture size 262144 bytes</span><br><span class="line">IP webb.ssh &gt; 192.168.111.1.43116: Flags [P.], <span class="built_in">seq</span> 1006738817:1006738933, ack 3034340408, win 501, options [nop,nop,TS val 3747773458 ecr 549468995], length 116</span><br><span class="line">IP 192.168.111.1.43116 &gt; webb.ssh: Flags [.], ack 116, win 3446, options [nop,nop,TS val 549469070 ecr 3747773458], length 0</span><br><span class="line">IP webb.ssh &gt; 192.168.111.1.43116: Flags [P.], <span class="built_in">seq</span> 116:152, ack 1, win 501, options [nop,nop,TS val 3747773458 ecr 549469070], length 36</span><br><span class="line">IP 192.168.111.1.43116 &gt; webb.ssh: Flags [.], ack 152, win 3446, options [nop,nop,TS val 549469070 ecr 3747773458], length 0</span><br><span class="line">...</span><br><span class="line">1049 packets captured</span><br><span class="line">1176 packets received by filter</span><br><span class="line">96 packets dropped by kernel</span><br></pre></td></tr></table></figure>

<h3 id="tt-每行输出时间戳"><a href="#tt-每行输出时间戳" class="headerlink" title="-tt 每行输出时间戳"></a>-tt 每行输出时间戳</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">root@webb:~<span class="comment"># tcpdump -tt</span></span><br><span class="line">tcpdump: verbose output suppressed, use -v or -vv <span class="keyword">for</span> full protocol decode</span><br><span class="line">listening on ens32, link-type EN10MB (Ethernet), capture size 262144 bytes</span><br><span class="line">1658248690.215415 IP webb.ssh &gt; 192.168.111.1.43116: Flags [P.], <span class="built_in">seq</span> 1006906525:1006906721, ack 3034341024, win 501, options [nop,nop,TS val 3748565045 ecr 550260577], length 196</span><br><span class="line">1658248690.215543 IP 192.168.111.1.43116 &gt; webb.ssh: Flags [.], ack 196, win 3446, options [nop,nop,TS val 550260641 ecr 3748565045], length 0</span><br><span class="line">1658248690.249773 IP kazooie.canonical.com.http &gt; webb.60558: Flags [P.], <span class="built_in">seq</span> 4222572013:4222573441, ack 3325110471, win 64240, length 1428: HTTP</span><br><span class="line">1658248690.249834 IP webb.60558 &gt; kazooie.canonical.com.http: Flags [.], ack 1428, win 65535, length 0</span><br><span class="line">1658248690.278397 IP webb.ssh &gt; 192.168.111.1.43116: Flags [P.], <span class="built_in">seq</span> 196:568, ack 1, win 501, options [nop,nop,TS val 3748565108 ecr 550260641], length 372</span><br><span class="line">...</span><br><span class="line">1583 packets captured</span><br><span class="line">1587 packets received by filter</span><br><span class="line">0 packets dropped by kernel</span><br></pre></td></tr></table></figure>

<h3 id="ttt-每两行输出时间戳"><a href="#ttt-每两行输出时间戳" class="headerlink" title="-ttt 每两行输出时间戳"></a>-ttt 每两行输出时间戳</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">root@webb:~<span class="comment"># tcpdump -ttt</span></span><br><span class="line">tcpdump: verbose output suppressed, use -v or -vv <span class="keyword">for</span> full protocol decode</span><br><span class="line">listening on ens32, link-type EN10MB (Ethernet), capture size 262144 bytes</span><br><span class="line"> 00:00:00.000000 IP webb.ssh &gt; 192.168.111.1.43116: Flags [P.], <span class="built_in">seq</span> 1007674849:1007675045, ack 3034341740, win 501, options [nop,nop,TS val 3748642834 ecr 550337390], length 196</span><br><span class="line"> 00:00:00.000438 IP 192.168.111.1.43116 &gt; webb.ssh: Flags [.], ack 196, win 3446, options [nop,nop,TS val 550338430 ecr 3748642834], length 0</span><br><span class="line"> 00:00:00.008378 IP webb.ssh &gt; 192.168.111.1.43116: Flags [P.], <span class="built_in">seq</span> 196:232, ack 1, win 501, options [nop,nop,TS val 3748642843 ecr 550338430], length 36</span><br><span class="line"> 00:00:00.000311 IP 192.168.111.1.43116 &gt; webb.ssh: Flags [.], ack 232, win 3446, options [nop,nop,TS val 550338439 ecr 3748642843], length 0</span><br><span class="line"> ...</span><br><span class="line">1063 packets captured</span><br><span class="line">1068 packets received by filter</span><br><span class="line">0 packets dropped by kernel</span><br></pre></td></tr></table></figure>

<h3 id="tttt-输出日期时间"><a href="#tttt-输出日期时间" class="headerlink" title="-tttt 输出日期时间"></a>-tttt 输出日期时间</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">root@webb:~<span class="comment"># tcpdump -tttt</span></span><br><span class="line">tcpdump: verbose output suppressed, use -v or -vv <span class="keyword">for</span> full protocol decode</span><br><span class="line">listening on ens32, link-type EN10MB (Ethernet), capture size 262144 bytes</span><br><span class="line">2022-07-19 16:41:04.792018 IP webb.ssh &gt; 192.168.111.1.43116: Flags [P.], <span class="built_in">seq</span> 1007865805:1007866001, ack 3034341928, win 501, options [nop,nop,TS val 3748739621 ecr 550435157], length 196</span><br><span class="line">2022-07-19 16:41:04.792158 IP 192.168.111.1.43116 &gt; webb.ssh: Flags [.], ack 196, win 3446, options [nop,nop,TS val 550435216 ecr 3748739621], length 0</span><br><span class="line">2022-07-19 16:41:04.895337 IP webb.ssh &gt; 192.168.111.1.43116: Flags [P.], <span class="built_in">seq</span> 196:584, ack 1, win 501, options [nop,nop,TS val 3748739725 ecr 550435216], length 388</span><br><span class="line">2022-07-19 16:41:04.895583 IP 192.168.111.1.43116 &gt; webb.ssh: Flags [.], ack 584, win 3446, options [nop,nop,TS val 550435319 ecr 3748739725], length 0</span><br><span class="line">...</span><br><span class="line">2184 packets captured</span><br><span class="line">2187 packets received by filter</span><br><span class="line">0 packets dropped by kernel</span><br></pre></td></tr></table></figure>

<h3 id="v-输出详细的信息（TTL，ID标识…）"><a href="#v-输出详细的信息（TTL，ID标识…）" class="headerlink" title="-v 输出详细的信息（TTL，ID标识…）"></a>-v 输出详细的信息（TTL，ID标识…）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">root@webb:~<span class="comment"># tcpdump -v</span></span><br><span class="line">tcpdump: listening on ens32, link-type EN10MB (Ethernet), capture size 262144 bytes</span><br><span class="line">16:43:43.939027 IP (tos 0x10, ttl 64, <span class="built_in">id</span> 23830, offset 0, flags [DF], proto TCP (6), length 184)</span><br><span class="line">    webb.ssh &gt; 192.168.111.1.43116: Flags [P.], <span class="built_in">cksum</span> 0x607e (incorrect -&gt; 0xf338), <span class="built_in">seq</span> 1008299485:1008299617, ack 3034342512, win 501, options [nop,nop,TS val 3748898768 ecr 550594296], length 132</span><br><span class="line">16:43:43.939166 IP (tos 0x0, ttl 64, <span class="built_in">id</span> 27031, offset 0, flags [DF], proto TCP (6), length 52)</span><br><span class="line">    192.168.111.1.43116 &gt; webb.ssh: Flags [.], <span class="built_in">cksum</span> 0x8ddc (correct), ack 132, win 3446, options [nop,nop,TS val 550594359 ecr 3748898768], length 0</span><br><span class="line">16:43:43.939182 IP (tos 0x10, ttl 64, <span class="built_in">id</span> 23831, offset 0, flags [DF], proto TCP (6), length 184)</span><br><span class="line">    webb.ssh &gt; 192.168.111.1.43116: Flags [P.], <span class="built_in">cksum</span> 0x607e (incorrect -&gt; 0xa60c), <span class="built_in">seq</span> 132:264, ack 1, win 501, options [nop,nop,TS val 3748898768 ecr 550594296], length 132</span><br><span class="line">...</span><br><span class="line">4815 packets captured</span><br><span class="line">5238 packets received by filter</span><br><span class="line">420 packets dropped by kernel</span><br></pre></td></tr></table></figure>

<h3 id="vv-显示比-v更多的信息（NFS回应包中的附加域，SMB数据包会完全解码）"><a href="#vv-显示比-v更多的信息（NFS回应包中的附加域，SMB数据包会完全解码）" class="headerlink" title="-vv 显示比-v更多的信息（NFS回应包中的附加域，SMB数据包会完全解码）"></a>-vv 显示比-v更多的信息（NFS回应包中的附加域，SMB数据包会完全解码）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">root@webb:~<span class="comment"># tcpdump -vv</span></span><br><span class="line">tcpdump: listening on ens32, link-type EN10MB (Ethernet), capture size 262144 bytes</span><br><span class="line">16:44:22.612405 IP (tos 0x10, ttl 64, <span class="built_in">id</span> 26920, offset 0, flags [DF], proto TCP (6), length 184)</span><br><span class="line">    webb.ssh &gt; 192.168.111.1.43116: Flags [P.], <span class="built_in">cksum</span> 0x607e (incorrect -&gt; 0x2bbc), <span class="built_in">seq</span> 1009762505:1009762637, ack 3034342880, win 501, options [nop,nop,TS val 3748937442 ecr 550632388], length 132</span><br><span class="line">16:44:22.613047 IP (tos 0x0, ttl 64, <span class="built_in">id</span> 29220, offset 0, flags [DF], proto TCP (6), length 52)</span><br><span class="line">    192.168.111.1.43116 &gt; webb.ssh: Flags [.], <span class="built_in">cksum</span> 0x0b49 (correct), <span class="built_in">seq</span> 1, ack 132, win 3446, options [nop,nop,TS val 550633029 ecr 3748937442], length 0</span><br><span class="line">16:44:22.614194 IP (tos 0x10, ttl 64, <span class="built_in">id</span> 26921, offset 0, flags [DF], proto TCP (6), length 184)</span><br><span class="line">    webb.ssh &gt; 192.168.111.1.43116: Flags [P.], <span class="built_in">cksum</span> 0x607e (incorrect -&gt; 0x546b), <span class="built_in">seq</span> 132:264, ack 1, win 501, options [nop,nop,TS val 3748937443 ecr 550633029], length 132</span><br><span class="line">...</span><br><span class="line">1006 packets captured</span><br><span class="line">1013 packets received by filter</span><br><span class="line">0 packets dropped by kernel</span><br></pre></td></tr></table></figure>

<h3 id="vvv-显示比-vv更多的信息（telnet使用的SB，SE选项会被打印）"><a href="#vvv-显示比-vv更多的信息（telnet使用的SB，SE选项会被打印）" class="headerlink" title="-vvv 显示比-vv更多的信息（telnet使用的SB，SE选项会被打印）"></a>-vvv 显示比-vv更多的信息（telnet使用的SB，SE选项会被打印）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">root@webb:~<span class="comment"># tcpdump -vvv</span></span><br><span class="line">tcpdump: listening on ens32, link-type EN10MB (Ethernet), capture size 262144 bytes</span><br><span class="line">16:44:59.706570 IP (tos 0x10, ttl 64, <span class="built_in">id</span> 27541, offset 0, flags [DF], proto TCP (6), length 104)</span><br><span class="line">    webb.ssh &gt; 192.168.111.1.43116: Flags [P.], <span class="built_in">cksum</span> 0x602e (incorrect -&gt; 0xaad1), <span class="built_in">seq</span> 1010065545:1010065597, ack 3034343176, win 501, options [nop,nop,TS val 3748974536 ecr 550670053], length 52</span><br><span class="line">16:44:59.706685 IP (tos 0x10, ttl 64, <span class="built_in">id</span> 27542, offset 0, flags [DF], proto TCP (6), length 168)</span><br><span class="line">    webb.ssh &gt; 192.168.111.1.43116: Flags [P.], <span class="built_in">cksum</span> 0x606e (incorrect -&gt; 0xf794), <span class="built_in">seq</span> 52:168, ack 1, win 501, options [nop,nop,TS val 3748974536 ecr 550670053], length 116</span><br><span class="line">16:44:59.706729 IP (tos 0x0, ttl 64, <span class="built_in">id</span> 29641, offset 0, flags [DF], proto TCP (6), length 52)</span><br><span class="line">    192.168.111.1.43116 &gt; webb.ssh: Flags [.], <span class="built_in">cksum</span> 0x48e2 (correct), <span class="built_in">seq</span> 1, ack 52, win 3446, options [nop,nop,TS val 550670120 ecr 3748974536], length 0</span><br><span class="line">16:44:59.706730 IP (tos 0x0, ttl 64, <span class="built_in">id</span> 29642, offset 0, flags [DF], proto TCP (6), length 52)</span><br><span class="line">    192.168.111.1.43116 &gt; webb.ssh: Flags [.], <span class="built_in">cksum</span> 0x486e (correct), <span class="built_in">seq</span> 1, ack 168, win 3446, options [nop,nop,TS val 550670120 ecr 3748974536], length 0</span><br><span class="line">...</span><br><span class="line">1200 packets captured</span><br><span class="line">1352 packets received by filter</span><br><span class="line">151 packets dropped by kernel</span><br></pre></td></tr></table></figure>

<h3 id="c-限制数据包次数"><a href="#c-限制数据包次数" class="headerlink" title="-c 限制数据包次数"></a>-c 限制数据包次数</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">root@webb:~<span class="comment"># tcpdump -c 20</span></span><br><span class="line">tcpdump: verbose output suppressed, use -v or -vv <span class="keyword">for</span> full protocol decode</span><br><span class="line">listening on ens32, link-type EN10MB (Ethernet), capture size 262144 bytes</span><br><span class="line">16:52:01.575503 IP webb.ssh &gt; 192.168.111.1.43116: Flags [P.], <span class="built_in">seq</span> 1010430833:1010431029, ack 3034344492, win 501, options [nop,nop,TS val 3749396405 ecr 551091899], length 196</span><br><span class="line">16:52:01.575643 IP 192.168.111.1.43116 &gt; webb.ssh: Flags [.], ack 196, win 3446, options [nop,nop,TS val 551091961 ecr 3749396405], length 0</span><br><span class="line">16:52:01.630839 IP webb.ssh &gt; 192.168.111.1.43116: Flags [P.], <span class="built_in">seq</span> 196:552, ack 1, win 501, options [nop,nop,TS val 3749396460 ecr 551091961], length 356</span><br><span class="line">16:52:01.631805 IP webb.ssh &gt; 192.168.111.1.43116: Flags [P.], <span class="built_in">seq</span> 2144:2628, ack 1, win 501, options [nop,nop,TS val 3749396461 ecr 551092017], length 484</span><br><span class="line">...</span><br><span class="line">16:52:01.631863 IP 192.168.111.1.43116 &gt; webb.ssh: Flags [.], ack 2628, win 3446, options [nop,nop,TS val 551092017 ecr 3749396461], length 0</span><br><span class="line">16:52:01.631874 IP webb.ssh &gt; 192.168.111.1.43116: Flags [P.], <span class="built_in">seq</span> 2628:3128, ack 1, win 501, options [nop,nop,TS val 3749396461 ecr 551092017], length 500</span><br><span class="line">16:52:01.631914 IP 192.168.111.1.43116 &gt; webb.ssh: Flags [.], ack 3128, win 3446, options [nop,nop,TS val 551092017 ecr 3749396461], length 0</span><br><span class="line">20 packets captured</span><br><span class="line">24 packets received by filter</span><br><span class="line">0 packets dropped by kernel</span><br></pre></td></tr></table></figure>

<h3 id="C-限制数据包文件大小"><a href="#C-限制数据包文件大小" class="headerlink" title="-C 限制数据包文件大小"></a>-C 限制数据包文件大小</h3><p>需要配合-w使用。如果数据包超过限制的大小就会生成一个新的文件用来保存数据包。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">root@webb:~<span class="comment"># tcpdump -C 1 -w abc</span></span><br><span class="line">tcpdump: listening on ens32, link-type EN10MB (Ethernet), capture size 262144 bytes</span><br><span class="line">1765 packets captured</span><br><span class="line">1767 packets received by filter</span><br><span class="line">0 packets dropped by kernel</span><br><span class="line"></span><br><span class="line">root@webb:~<span class="comment"># ls -lh</span></span><br><span class="line">total 7.7M</span><br><span class="line">-rw-r--r-- 1 root root 1009K Jul 19 17:15 abc</span><br><span class="line">-rw-r--r-- 1 root root  980K Jul 19 17:15 abc1</span><br><span class="line">-rw-r--r-- 1 root root  993K Jul 19 17:15 abc2</span><br><span class="line">-rw-r--r-- 1 root root  986K Jul 19 17:15 abc3</span><br><span class="line">-rw-r--r-- 1 root root  979K Jul 19 17:16 abc4</span><br><span class="line">-rw-r--r-- 1 root root  983K Jul 19 17:16 abc5</span><br><span class="line">-rw-r--r-- 1 root root  990K Jul 19 17:16 abc6</span><br><span class="line">-rw-r--r-- 1 root root  861K Jul 19 17:16 abc7</span><br></pre></td></tr></table></figure>

<h3 id="W-限制写入文件次数"><a href="#W-限制写入文件次数" class="headerlink" title="-W 限制写入文件次数"></a>-W 限制写入文件次数</h3><p>如果限定的文件都写满了以后会从第一个文件开始写。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">root@webb:~/test<span class="comment"># tcpdump -C 1 -W 3 -w test</span></span><br><span class="line">tcpdump: listening on ens32, link-type EN10MB (Ethernet), capture size 262144 bytes</span><br><span class="line">^C1882 packets captured</span><br><span class="line">1885 packets received by filter</span><br><span class="line">0 packets dropped by kernel</span><br><span class="line"></span><br><span class="line">root@webb:~/test<span class="comment"># ls -lh</span></span><br><span class="line">total 2.1M</span><br><span class="line">-rw-r--r-- 1 root root  123K Jul 19 17:23 test0</span><br><span class="line">-rw-r--r-- 1 root root 1011K Jul 19 17:23 test1</span><br><span class="line">-rw-r--r-- 1 root root  979K Jul 19 17:23 test2</span><br></pre></td></tr></table></figure>

<h3 id="Q-选择输入或输出方向的数据"><a href="#Q-选择输入或输出方向的数据" class="headerlink" title="-Q 选择输入或输出方向的数据"></a>-Q 选择输入或输出方向的数据</h3><p>参数：in out inout。</p>
<ul>
<li>输入（下载）</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">root@webb:~<span class="comment"># tcpdump -Q in</span></span><br><span class="line">tcpdump: verbose output suppressed, use -v or -vv <span class="keyword">for</span> full protocol decode</span><br><span class="line">listening on ens32, link-type EN10MB (Ethernet), capture size 262144 bytes</span><br><span class="line">17:58:53.985215 IP 192.168.111.1.43848 &gt; webb.ssh: Flags [.], ack 3183598209, win 648, options [nop,nop,TS val 555104219 ecr 2635667664], length 0</span><br><span class="line">17:58:54.021439 IP _gateway.domain &gt; webb.51745: 10421 NXDomain 0/0/0 (46)</span><br><span class="line">17:58:54.060765 IP _gateway.domain &gt; webb.41578: 23900 NXDomain 0/0/0 (44)</span><br><span class="line">17:58:54.061448 IP 192.168.111.1.43848 &gt; webb.ssh: Flags [.], ack 197, win 648, options [nop,nop,TS val 555104295 ecr 2635667740], length 0</span><br><span class="line">17:58:54.072872 IP 192.168.111.1.34450 &gt; 239.255.255.250.1900: UDP, length 173</span><br><span class="line">17:58:54.109763 IP _gateway.domain &gt; webb.40561: 33080 NXDomain 0/0/0 (44)</span><br><span class="line">...</span><br><span class="line">12057 packets captured</span><br><span class="line">24298 packets received by filter</span><br><span class="line">155 packets dropped by kernel</span><br></pre></td></tr></table></figure>

<ul>
<li>输出（上传）</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">root@webb:~<span class="comment"># tcpdump -Q out</span></span><br><span class="line">tcpdump: verbose output suppressed, use -v or -vv <span class="keyword">for</span> full protocol decode</span><br><span class="line">listening on ens32, link-type EN10MB (Ethernet), capture size 262144 bytes</span><br><span class="line">18:00:37.877483 IP webb.ssh &gt; 192.168.111.1.43848: Flags [P.], <span class="built_in">seq</span> 3185769101:3185769217, ack 36164978, win 501, options [nop,nop,TS val 2635771556 ecr 555208041], length 116</span><br><span class="line">18:00:37.877730 IP webb.ssh &gt; 192.168.111.1.43848: Flags [P.], <span class="built_in">seq</span> 116:152, ack 1, win 501, options [nop,nop,TS val 2635771557 ecr 555208108], length 36</span><br><span class="line">18:00:37.877873 IP webb.ssh &gt; 192.168.111.1.43848: Flags [P.], <span class="built_in">seq</span> 152:268, ack 1, win 501, options [nop,nop,TS val 2635771557 ecr 555208108], length 116</span><br><span class="line">18:00:37.877985 IP webb.ssh &gt; 192.168.111.1.43848: Flags [P.], <span class="built_in">seq</span> 268:304, ack 1, win 501, options [nop,nop,TS val 2635771557 ecr 555208108], length 36</span><br><span class="line">18:00:37.878707 IP webb.49487 &gt; _gateway.domain: 20848+ PTR? 1.111.168.192.in-addr.arpa. (44)</span><br><span class="line">...</span><br><span class="line">1636 packets captured</span><br><span class="line">3248 packets received by filter</span><br><span class="line">9 packets dropped by kernel</span><br></pre></td></tr></table></figure>

<h3 id="q-显示简洁的信息"><a href="#q-显示简洁的信息" class="headerlink" title="-q 显示简洁的信息"></a>-q 显示简洁的信息</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">root@webb:~<span class="comment"># tcpdump -q </span></span><br><span class="line">tcpdump: verbose output suppressed, use -v or -vv <span class="keyword">for</span> full protocol decode</span><br><span class="line">listening on ens32, link-type EN10MB (Ethernet), capture size 262144 bytes</span><br><span class="line">18:11:47.861165 IP webb.ssh &gt; 192.168.111.1.43848: tcp 196</span><br><span class="line">18:11:47.861317 IP 192.168.111.1.43848 &gt; webb.ssh: tcp 0</span><br><span class="line">18:11:47.862202 IP webb.51236 &gt; _gateway.domain: UDP, length 44</span><br><span class="line">18:11:47.883263 IP _gateway.domain &gt; webb.51236: UDP, length 44</span><br><span class="line">18:11:47.884388 IP webb.60867 &gt; _gateway.domain: UDP, length 46</span><br><span class="line">18:11:47.913492 IP _gateway.domain &gt; webb.60867: UDP, length 46</span><br><span class="line">18:11:47.914114 IP webb.ssh &gt; 192.168.111.1.43848: tcp 164</span><br><span class="line">18:11:47.914307 IP 192.168.111.1.43848 &gt; webb.ssh: tcp 0</span><br><span class="line">18:11:47.914471 IP webb.36870 &gt; _gateway.domain: UDP, length 44</span><br><span class="line">18:11:47.943661 IP _gateway.domain &gt; webb.36870: UDP, length 44</span><br><span class="line">18:11:47.945832 IP webb.ssh &gt; 192.168.111.1.43848: tcp 308</span><br><span class="line">...</span><br><span class="line">1662 packets captured</span><br><span class="line">1662 packets received by filter</span><br><span class="line">0 packets dropped by kernel</span><br></pre></td></tr></table></figure>

<h3 id="D-显示可以用的网卡"><a href="#D-显示可以用的网卡" class="headerlink" title="-D 显示可以用的网卡"></a>-D 显示可以用的网卡</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">root@webb:~<span class="comment"># tcpdump -D</span></span><br><span class="line">1.ens32 [Up, Running]</span><br><span class="line">2.docker0 [Up, Running]</span><br><span class="line">3.veth718d71e [Up, Running]</span><br><span class="line">4.lo [Up, Running, Loopback]</span><br><span class="line">5.any (Pseudo-device that captures on all interfaces) [Up, Running]</span><br><span class="line">6.br-2c5c2f3c07b0 [Up]</span><br><span class="line">7.br-8176041516e6 [Up]</span><br><span class="line">8.br-78e4c3004a16 [Up]</span><br><span class="line">9.br-653aa4c4ca24 [Up]</span><br><span class="line">10.br-0b50877f0c80 [Up]</span><br><span class="line">11.br-4a5364f0c91e [Up]</span><br><span class="line">12.br-65553a1d414f [Up]</span><br><span class="line">13.br-b2f360fdd976 [Up]</span><br><span class="line">14.br-388fed18724d [Up]</span><br><span class="line">15.br-67a000c23451 [Up]</span><br><span class="line">16.br-4c01ac860111 [Up]</span><br><span class="line">17.br-aa15e7478112 [Up]</span><br><span class="line">18.bluetooth-monitor (Bluetooth Linux Monitor) [none]</span><br><span class="line">19.nflog (Linux netfilter <span class="built_in">log</span> (NFLOG) interface) [none]</span><br><span class="line">20.nfqueue (Linux netfilter queue (NFQUEUE) interface) [none]</span><br></pre></td></tr></table></figure>

<h3 id="L-显示某个网卡已只数据链路信息"><a href="#L-显示某个网卡已只数据链路信息" class="headerlink" title="-L 显示某个网卡已只数据链路信息"></a>-L 显示某个网卡已只数据链路信息</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root@webb:~<span class="comment"># tcpdump -L</span></span><br><span class="line">Data <span class="built_in">link</span> types <span class="keyword">for</span> ens32 (use option -y to <span class="built_in">set</span>):</span><br><span class="line">  EN10MB (Ethernet)</span><br><span class="line">  DOCSIS (DOCSIS) (printing not supported)</span><br></pre></td></tr></table></figure>

<h3 id="S-指定每个数据包的长度"><a href="#S-指定每个数据包的长度" class="headerlink" title="-S 指定每个数据包的长度"></a>-S 指定每个数据包的长度</h3><p>如果超过设定的大小限制，数据包会被截断，而每行会出现[|协议]这种标识。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">root@webb:~<span class="comment"># tcpdump -s 50</span></span><br><span class="line">tcpdump: verbose output suppressed, use -v or -vv <span class="keyword">for</span> full protocol decode</span><br><span class="line">listening on ens32, link-type EN10MB (Ethernet), capture size 50 bytes</span><br><span class="line">03:25:19.730692 IP webb.ssh &gt; 192.168.111.1.43848: [|tcp]</span><br><span class="line">03:25:19.730844 IP 192.168.111.1.43848 &gt; webb.ssh: [|tcp]</span><br><span class="line">03:25:19.730854 IP webb.ssh &gt; 192.168.111.1.43848: [|tcp]</span><br><span class="line">03:25:19.730912 IP 192.168.111.1.43848 &gt; webb.ssh: [|tcp]</span><br><span class="line">03:25:19.730949 IP webb.ssh &gt; 192.168.111.1.43848: [|tcp]</span><br><span class="line">03:25:19.731011 IP 192.168.111.1.43848 &gt; webb.ssh: [|tcp]</span><br><span class="line">03:25:19.731511 IP webb.53133 &gt; _gateway.domain: [|domain]</span><br><span class="line">03:25:19.758616 IP _gateway.domain &gt; webb.53133: [|domain]</span><br><span class="line">...</span><br><span class="line">2331 packets captured</span><br><span class="line">2333 packets received by filter</span><br><span class="line">0 packets dropped by kernel</span><br></pre></td></tr></table></figure>

<h3 id="A-数据包的信息用ASCII字符串显示"><a href="#A-数据包的信息用ASCII字符串显示" class="headerlink" title="-A 数据包的信息用ASCII字符串显示"></a>-A 数据包的信息用ASCII字符串显示</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">root@webb:~<span class="comment"># tcpdump -A </span></span><br><span class="line">tcpdump: verbose output suppressed, use -v or -vv <span class="keyword">for</span> full protocol decode</span><br><span class="line">listening on ens32, link-type EN10MB (Ethernet), capture size 262144 bytes</span><br><span class="line">03:29:41.935419 IP webb.ssh &gt; 192.168.111.1.43848: Flags [P.], <span class="built_in">seq</span> 3187380677:3187380873, ack 36172546, win 501, options [nop,nop,TS val 2637269641 ecr 556706107], length 196</span><br><span class="line">E.....@.@..)..o...o....H.....<span class="string">&#x27;......`......</span></span><br><span class="line"><span class="string">.1..!..;.....;.....y.X........E...&#125;+..O1..rA.L..[       .6...&lt;p..*.........f?&#x27;</span>CZ...N..;...).X.Su;.`......ZNX...:.RDxJ..&gt;D.uZ8...!...A./.......V.?......j9....)......U.X6..B&gt;E=e..[^....X..<span class="string">&#x27;].&gt;M..&amp;.d...&amp;.....m....</span></span><br><span class="line"><span class="string">03:29:41.935548 IP 192.168.111.1.43848 &gt; webb.ssh: Flags [.], ack 196, win 12278, options [nop,nop,TS val 556706161 ecr 2637269641], length 0</span></span><br><span class="line"><span class="string">E..4\.@.@.~9..o...o..H...&#x27;</span>......../........</span><br><span class="line">!..q.1..</span><br><span class="line">03:29:41.936377 IP webb.33513 &gt; _gateway.domain: 6457+ PTR? 1.111.168.192.in-addr.arpa. (44)</span><br><span class="line">E..H6.@.@.....o...o....5.4`..9...........1.111.168.192.in-addr.arpa.....</span><br><span class="line">3 packets captured</span><br><span class="line">13 packets received by filter</span><br><span class="line">0 packets dropped by kernel</span><br></pre></td></tr></table></figure>

<h3 id="X-数据包的信息用十六进制和ASCII字符串显示"><a href="#X-数据包的信息用十六进制和ASCII字符串显示" class="headerlink" title="-X 数据包的信息用十六进制和ASCII字符串显示"></a>-X 数据包的信息用十六进制和ASCII字符串显示</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">root@webb:~<span class="comment"># tcpdump -X </span></span><br><span class="line">tcpdump: verbose output suppressed, use -v or -vv <span class="keyword">for</span> full protocol decode</span><br><span class="line">listening on ens32, link-type EN10MB (Ethernet), capture size 262144 bytes</span><br><span class="line">03:32:53.459045 IP webb.ssh &gt; 192.168.111.1.43848: Flags [P.], <span class="built_in">seq</span> 3187382901:3187383097, ack 36173466, win 501, options [nop,nop,TS val 2637461164 ecr 556897624], length 196</span><br><span class="line">        0x0000:  4510 00f8 2f0f 4000 4006 ab0d c0a8 6f81  E.../.@.@.....o.</span><br><span class="line">        0x0010:  c0a8 6f01 0016 ab48 bdfb 9a75 0227 f69a  ..o....H...u.<span class="string">&#x27;..</span></span><br><span class="line"><span class="string">        0x0020:  8018 01f5 60be 0000 0101 080a 9d34 76ac  ....`........4v.</span></span><br><span class="line"><span class="string">        0x0030:  2131 9558 0000 00b0 cce9 d735 79ce 5a55  !1.X.......5y.ZU</span></span><br><span class="line"><span class="string">        0x0040:  9f4b 8734 e72f d4f1 a980 261f f5b6 c1bb  .K.4./....&amp;.....</span></span><br><span class="line"><span class="string">        0x0050:  0294 1623 1ddf 77ff 9a52 1714 8b60 6206  ...#..w..R...`b.</span></span><br><span class="line"><span class="string">        0x0060:  50ef e4d4 3eb3 1a99 dff8 8eaf 6edd 8d70  P...&gt;.......n..p</span></span><br><span class="line"><span class="string">        0x0070:  ed4c 257d 2837 cd81 449c f9ea 2569 6fa5  .L%&#125;(7..D...%io.</span></span><br><span class="line"><span class="string">        0x0080:  f6df 019c c77c 0b5c cf27 662f 787f 53c3  .....|.\.&#x27;</span>f/x.S.</span><br><span class="line">        0x0090:  64e0 239f cd91 8d20 bd18 a5b0 76eb 0750  d.<span class="comment">#.........v..P</span></span><br><span class="line">        0x00a0:  190f 1c22 7330 d317 3d68 7068 4cb6 767c  ...<span class="string">&quot;s0..=hphL.v|</span></span><br><span class="line"><span class="string">        0x00b0:  11b4 4a41 0547 1411 f6b1 8783 9dc3 ec63  ..JA.G.........c</span></span><br><span class="line"><span class="string">        0x00c0:  38f1 00fb c79b 4bec c243 e609 944e f0e2  8.....K..C...N..</span></span><br><span class="line"><span class="string">        0x00d0:  f765 3af6 428f 4773 9d1c b8e4 37aa 279f  .e:.B.Gs....7.&#x27;.</span></span><br><span class="line"><span class="string">        0x00e0:  a9d5 06fd 9d62 49aa c640 7fbd 1c6c 2035  .....bI..@...l.5</span></span><br><span class="line"><span class="string">        0x00f0:  bbb3 4abf 1a3c b009                      ..J..&lt;..</span></span><br><span class="line"><span class="string">03:32:53.459186 IP 192.168.111.1.43848 &gt; webb.ssh: Flags [.], ack 196, win 12293, options [nop,nop,TS val 556897684 ecr 2637461164], length 0</span></span><br><span class="line"><span class="string">        0x0000:  4500 0034 5ce9 4000 4006 7e07 c0a8 6f01  E..4\.@.@.~...o.</span></span><br><span class="line"><span class="string">        0x0010:  c0a8 6f81 ab48 0016 0227 f69a bdfb 9b39  ..o..H...&#x27;.....9</span></span><br><span class="line"><span class="string">        0x0020:  8010 3005 1ee8 0000 0101 080a 2131 9594  ..0.........!1..</span></span><br><span class="line"><span class="string">        0x0030:  9d34 76ac                                .4v.</span></span><br><span class="line"><span class="string">03:32:53.459848 IP webb.46115 &gt; _gateway.domain: 9560+ PTR? 1.111.168.192.in-addr.arpa. (44)</span></span><br><span class="line"><span class="string">        0x0000:  4500 0048 722f 4000 4011 68a1 c0a8 6f81  E..Hr/@.@.h...o.</span></span><br><span class="line"><span class="string">        0x0010:  c0a8 6f02 b423 0035 0034 601a 2558 0100  ..o..#.5.4`.%X..</span></span><br><span class="line"><span class="string">        0x0020:  0001 0000 0000 0000 0131 0331 3131 0331  .........1.111.1</span></span><br><span class="line"><span class="string">        0x0030:  3638 0331 3932 0769 6e2d 6164 6472 0461  68.192.in-addr.a</span></span><br><span class="line"><span class="string">        0x0040:  7270 6100 000c 0001                      rpa.....</span></span><br><span class="line"><span class="string">3 packets captured</span></span><br><span class="line"><span class="string">15 packets received by filter</span></span><br><span class="line"><span class="string">0 packets dropped by kernel</span></span><br></pre></td></tr></table></figure>

<h3 id="e-显示数据链路层的头部信息（MAC地址、VLAN-tag信息）"><a href="#e-显示数据链路层的头部信息（MAC地址、VLAN-tag信息）" class="headerlink" title="-e 显示数据链路层的头部信息（MAC地址、VLAN tag信息）"></a>-e 显示数据链路层的头部信息（MAC地址、VLAN tag信息）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">root@webb:~<span class="comment"># tcpdump -e </span></span><br><span class="line">tcpdump: verbose output suppressed, use -v or -vv <span class="keyword">for</span> full protocol decode</span><br><span class="line">listening on ens32, link-type EN10MB (Ethernet), capture size 262144 bytes</span><br><span class="line">03:36:06.230854 00:0c:29:6b:19:3c (oui Unknown) &gt; 00:50:56:c0:00:08 (oui Unknown), ethertype IPv4 (0x0800), length 262: webb.ssh &gt; 192.168.111.1.43848: Flags [P.], <span class="built_in">seq</span> 3187386301:3187386497, ack 36174278, win 501, options [nop,nop,TS val 2637653936 ecr 557090387], length 196</span><br><span class="line">03:36:06.230950 00:50:56:c0:00:08 (oui Unknown) &gt; 00:0c:29:6b:19:3c (oui Unknown), ethertype IPv4 (0x0800), length 66: 192.168.111.1.43848 &gt; webb.ssh: Flags [.], ack 196, win 12315, options [nop,nop,TS val 557090454 ecr 2637653936], length 0</span><br><span class="line">03:36:06.231603 00:0c:29:6b:19:3c (oui Unknown) &gt; 00:50:56:f3:ae:21 (oui Unknown), ethertype IPv4 (0x0800), length 86: webb.40574 &gt; _gateway.domain: 36789+ PTR? 1.111.168.192.in-addr.arpa. (44)</span><br><span class="line">3 packets captured</span><br><span class="line">10 packets received by filter</span><br><span class="line">0 packets dropped by kernel</span><br></pre></td></tr></table></figure>

<h3 id="F-使用文件中的过滤规则"><a href="#F-使用文件中的过滤规则" class="headerlink" title="-F 使用文件中的过滤规则"></a>-F 使用文件中的过滤规则</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">root@webb:~<span class="comment"># cat filter_rule </span></span><br><span class="line">tcp port 80</span><br><span class="line"></span><br><span class="line">root@webb:~<span class="comment"># tcpdump -F filter_rule -i ens32</span></span><br><span class="line">tcpdump: verbose output suppressed, use -v or -vv <span class="keyword">for</span> full protocol decode</span><br><span class="line">listening on ens32, link-type EN10MB (Ethernet), capture size 262144 bytes</span><br><span class="line">03:43:06.217104 IP webb.43088 &gt; 120.41.45.103.http: Flags [S], <span class="built_in">seq</span> 1123306280, win 64240, options [mss 1460,sackOK,TS val 278585417 ecr 0,nop,wscale 7], length 0</span><br><span class="line">03:43:06.246672 IP 120.41.45.103.http &gt; webb.43088: Flags [S.], <span class="built_in">seq</span> 2338310987, ack 1123306281, win 64240, options [mss 1460], length 0</span><br><span class="line">03:43:06.246733 IP webb.43088 &gt; 120.41.45.103.http: Flags [.], ack 1, win 64240, length 0</span><br><span class="line">03:43:06.246819 IP webb.43088 &gt; 120.41.45.103.http: Flags [P.], <span class="built_in">seq</span> 1:75, ack 1, win 64240, length 74: HTTP: GET /VersionControl.dat HTTP/1.1</span><br><span class="line">03:43:06.246999 IP 120.41.45.103.http &gt; webb.43088: Flags [.], ack 75, win 64240, length 0</span><br><span class="line">03:43:06.286821 IP 120.41.45.103.http &gt; webb.43088: Flags [P.], <span class="built_in">seq</span> 1:1049, ack 75, win 64240, length 1048: HTTP: HTTP/1.1 200 OK</span><br><span class="line">03:43:06.286897 IP webb.43088 &gt; 120.41.45.103.http: Flags [.], ack 1049, win 63928, length 0</span><br><span class="line">...</span><br><span class="line">14 packets captured</span><br><span class="line">18 packets received by filter</span><br><span class="line">0 packets dropped by kernel</span><br></pre></td></tr></table></figure>

<h3 id="l-对标准输出进行行缓冲（标准输出遇到一个换行符就马上把这行的内容打印出来）。"><a href="#l-对标准输出进行行缓冲（标准输出遇到一个换行符就马上把这行的内容打印出来）。" class="headerlink" title="-l 对标准输出进行行缓冲（标准输出遇到一个换行符就马上把这行的内容打印出来）。"></a>-l 对标准输出进行行缓冲（标准输出遇到一个换行符就马上把这行的内容打印出来）。</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">root@webb:~<span class="comment"># tcpdump -l | tee data</span></span><br><span class="line">tcpdump: verbose output suppressed, use -v or -vv <span class="keyword">for</span> full protocol decode</span><br><span class="line">listening on ens32, link-type EN10MB (Ethernet), capture size 262144 bytes</span><br><span class="line">03:49:41.850910 IP webb.ssh &gt; 192.168.111.1.43848: Flags [P.], <span class="built_in">seq</span> 3188656729:3188656925, ack 36189394, win 501, options [nop,nop,TS val 2638469556 ecr 557905972], length 196</span><br><span class="line">03:49:41.851026 IP 192.168.111.1.43848 &gt; webb.ssh: Flags [.], ack 196, win 12791, options [nop,nop,TS val 557906030 ecr 2638469556], length 0</span><br><span class="line">03:49:42.839861 IP webb.51943 &gt; _gateway.domain: 14084+ PTR? 1.111.168.192.in-addr.arpa. (44)</span><br><span class="line">03:49:42.865887 IP _gateway.domain &gt; webb.51943: 14084 NXDomain 0/0/0 (44)</span><br><span class="line">03:49:42.868939 IP webb.50062 &gt; _gateway.domain: 8041+ PTR? 129.111.168.192.in-addr.arpa. (46)</span><br><span class="line">03:49:42.897498 IP _gateway.domain &gt; webb.50062: 8041 NXDomain 0/0/0 (46)</span><br><span class="line">03:49:42.900392 IP webb.ssh &gt; 192.168.111.1.43848: Flags [P.], <span class="built_in">seq</span> 196:552, ack 1, win 501, options [nop,nop,TS val 2638470606 ecr 557906030], length 356</span><br><span class="line">03:49:42.901005 IP 192.168.111.1.43848 &gt; webb.ssh: Flags [.], ack 552, win 12791, options [nop,nop,TS val 557907080 ecr 2638470606], length 0</span><br><span class="line">03:49:42.902050 IP webb.ssh &gt; 192.168.111.1.43848: Flags [P.], <span class="built_in">seq</span> 552:588, ack 1, win 501, options [nop,nop,TS val 2638470607 ecr 557907080], length 36</span><br><span class="line">03:49:42.902402 IP 192.168.111.1.43848 &gt; webb.ssh: Flags [.], ack 588, win 12791, options [nop,nop,TS val 557907082 ecr 2638470607], length 0</span><br><span class="line">10 packets captured</span><br><span class="line">17 packets received by filter</span><br><span class="line">0 packets dropped by kernel</span><br></pre></td></tr></table></figure>

<h2 id="逻辑运算符"><a href="#逻辑运算符" class="headerlink" title="逻辑运算符"></a>逻辑运算符</h2><h3 id="and-x2F-amp-amp-满足所有条件"><a href="#and-x2F-amp-amp-满足所有条件" class="headerlink" title="and&#x2F;&amp;&amp; 满足所有条件"></a>and&#x2F;&amp;&amp; 满足所有条件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">root@webb:~<span class="comment"># tcpdump src 192.168.1.1 and port 80</span></span><br><span class="line">tcpdump: verbose output suppressed, use -v or -vv <span class="keyword">for</span> full protocol decode</span><br><span class="line">listening on ens32, link-type EN10MB (Ethernet), capture size 262144 bytes</span><br><span class="line">03:53:43.308323 IP gw.gcableconfig.local.http &gt; webb.49650: Flags [S.], <span class="built_in">seq</span> 1487312683, ack 4054784189, win 64240, options [mss 1460], length 0</span><br><span class="line">03:53:43.308918 IP gw.gcableconfig.local.http &gt; webb.49650: Flags [.], ack 76, win 64240, length 0</span><br><span class="line">03:53:43.315012 IP gw.gcableconfig.local.http &gt; webb.49650: Flags [P.], <span class="built_in">seq</span> 1:2897, ack 76, win 64240, length 2896: HTTP: HTTP/1.0 200 OK</span><br><span class="line">03:53:43.321661 IP gw.gcableconfig.local.http &gt; webb.49650: Flags [FP.], <span class="built_in">seq</span> 2897:5303, ack 76, win 64240, length 2406: HTTP</span><br><span class="line">03:53:43.322855 IP gw.gcableconfig.local.http &gt; webb.49650: Flags [.], ack 77, win 64239, length 0</span><br><span class="line">5 packets captured</span><br><span class="line">5 packets received by filter</span><br><span class="line">0 packets dropped by kernel</span><br></pre></td></tr></table></figure>

<h3 id="or-x2F-只满足一个条件"><a href="#or-x2F-只满足一个条件" class="headerlink" title="or&#x2F;|| 只满足一个条件"></a>or&#x2F;|| 只满足一个条件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">root@webb:~<span class="comment"># tcpdump tcp port 53 or udp port 53</span></span><br><span class="line">tcpdump: verbose output suppressed, use -v or -vv <span class="keyword">for</span> full protocol decode</span><br><span class="line">listening on ens32, link-type EN10MB (Ethernet), capture size 262144 bytes</span><br><span class="line">03:54:53.621757 IP webb.56996 &gt; _gateway.domain: 36025+ A? webb-l.top. (28)</span><br><span class="line">03:54:53.623207 IP webb.47043 &gt; _gateway.domain: 12683+ AAAA? webb-l.top. (28)</span><br><span class="line">03:54:53.627082 IP webb.59208 &gt; _gateway.domain: 45958+ PTR? 2.111.168.192.in-addr.arpa. (44)</span><br><span class="line">03:54:53.680540 IP _gateway.domain &gt; webb.59208: 45958 NXDomain 0/0/0 (44)</span><br><span class="line">03:54:53.681699 IP webb.36977 &gt; _gateway.domain: 37135+ PTR? 129.111.168.192.in-addr.arpa. (46)</span><br><span class="line">03:54:53.711146 IP _gateway.domain &gt; webb.36977: 37135 NXDomain 0/0/0 (46)</span><br><span class="line">03:54:53.711433 IP _gateway.domain &gt; webb.56996: 36025 5/0/0 CNAME webb-l.github.io., A 185.199.109.153, A 185.199.111.153, A 185.199.110.153, A 185.199.108.153 (122)</span><br><span class="line">03:54:53.711433 IP _gateway.domain &gt; webb.47043: 12683 5/0/0 CNAME webb-l.github.io., AAAA 2606:50c0:8000::153, AAAA 2606:50c0:8003::153, AAAA 2606:50c0:8002::153, AAAA 2606:50c0:8001::153 (170)</span><br><span class="line">03:54:53.741361 IP webb.52080 &gt; _gateway.domain: 4388+ PTR? 153.108.199.185.in-addr.arpa. (46)</span><br><span class="line">03:54:53.789243 IP _gateway.domain &gt; webb.52080: 4388 1/0/0 PTR cdn-185-199-108-153.github.com. (90)</span><br><span class="line">10 packets captured</span><br><span class="line">10 packets received by filter</span><br><span class="line">0 packets dropped by kernel</span><br></pre></td></tr></table></figure>

<h3 id="not-x2F-取反"><a href="#not-x2F-取反" class="headerlink" title="not&#x2F;! 取反"></a>not&#x2F;! 取反</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">root@webb:~<span class="comment"># tcpdump not tcp port 22</span></span><br><span class="line">tcpdump: verbose output suppressed, use -v or -vv <span class="keyword">for</span> full protocol decode</span><br><span class="line">listening on ens32, link-type EN10MB (Ethernet), capture size 262144 bytes</span><br><span class="line">03:55:30.206918 IP webb &gt; cdn-185-199-108-153.github.com: ICMP <span class="built_in">echo</span> request, <span class="built_in">id</span> 1, <span class="built_in">seq</span> 37, length 64</span><br><span class="line">03:55:30.209607 IP webb.54773 &gt; _gateway.domain: 56005+ PTR? 153.108.199.185.in-addr.arpa. (46)</span><br><span class="line">03:55:30.230574 IP cdn-185-199-108-153.github.com &gt; webb: ICMP <span class="built_in">echo</span> reply, <span class="built_in">id</span> 1, <span class="built_in">seq</span> 37, length 64</span><br><span class="line">03:55:30.239947 IP _gateway.domain &gt; webb.54773: 56005 1/0/0 PTR cdn-185-199-108-153.github.com. (90)</span><br><span class="line">03:55:30.242390 IP webb.37901 &gt; _gateway.domain: 6529+ PTR? 129.111.168.192.in-addr.arpa. (46)</span><br><span class="line">03:55:30.270067 IP _gateway.domain &gt; webb.37901: 6529 NXDomain 0/0/0 (46)</span><br><span class="line">03:55:30.273460 IP webb.47470 &gt; _gateway.domain: 3405+ PTR? 2.111.168.192.in-addr.arpa. (44)</span><br><span class="line">03:55:30.299833 IP _gateway.domain &gt; webb.47470: 3405 NXDomain 0/0/0 (44)</span><br><span class="line">8 packets captured</span><br><span class="line">8 packets received by filter</span><br><span class="line">0 packets dropped by kernel</span><br></pre></td></tr></table></figure>

<h3 id="多个逻辑运算符组合"><a href="#多个逻辑运算符组合" class="headerlink" title="多个逻辑运算符组合"></a>多个逻辑运算符组合</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">root@webb:~<span class="comment"># tcpdump &quot;src 192.168.1.1 and (tcp port 80 or icmp)&quot;</span></span><br><span class="line">tcpdump: verbose output suppressed, use -v or -vv <span class="keyword">for</span> full protocol decode</span><br><span class="line">listening on ens32, link-type EN10MB (Ethernet), capture size 262144 bytes</span><br><span class="line">03:59:10.994485 IP gw.gcableconfig.local &gt; webb: ICMP <span class="built_in">echo</span> reply, <span class="built_in">id</span> 4, <span class="built_in">seq</span> 1, length 64</span><br><span class="line">03:59:14.370158 IP gw.gcableconfig.local.http &gt; webb.49676: Flags [S.], <span class="built_in">seq</span> 1740528049, ack 465635601, win 64240, options [mss 1460], length 0</span><br><span class="line">03:59:14.370455 IP gw.gcableconfig.local.http &gt; webb.49676: Flags [.], ack 76, win 64240, length 0</span><br><span class="line">03:59:14.383240 IP gw.gcableconfig.local.http &gt; webb.49676: Flags [P.], <span class="built_in">seq</span> 1:2897, ack 76, win 64240, length 2896: HTTP: HTTP/1.0 200 OK</span><br><span class="line">03:59:14.390582 IP gw.gcableconfig.local.http &gt; webb.49676: Flags [FP.], <span class="built_in">seq</span> 2897:5303, ack 76, win 64240, length 2406: HTTP</span><br><span class="line">03:59:14.391307 IP gw.gcableconfig.local.http &gt; webb.49676: Flags [.], ack 77, win 64239, length 0</span><br><span class="line">03:59:20.560951 IP gw.gcableconfig.local &gt; webb: ICMP <span class="built_in">echo</span> reply, <span class="built_in">id</span> 5, <span class="built_in">seq</span> 1, length 64</span><br><span class="line">03:59:21.561663 IP gw.gcableconfig.local &gt; webb: ICMP <span class="built_in">echo</span> reply, <span class="built_in">id</span> 5, <span class="built_in">seq</span> 2, length 64</span><br><span class="line">8 packets captured</span><br><span class="line">8 packets received by filter</span><br><span class="line">0 packets dropped by kernel</span><br></pre></td></tr></table></figure>

<h2 id="高级过滤"><a href="#高级过滤" class="headerlink" title="高级过滤"></a>高级过滤</h2><h3 id="less-抓取数据包小于xx-bytes的数据包"><a href="#less-抓取数据包小于xx-bytes的数据包" class="headerlink" title="less 抓取数据包小于xx bytes的数据包"></a>less 抓取数据包小于xx bytes的数据包</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">root@webb:~<span class="comment"># tcpdump less 100 -c 3 </span></span><br><span class="line">tcpdump: verbose output suppressed, use -v or -vv <span class="keyword">for</span> full protocol decode</span><br><span class="line">listening on ens32, link-type EN10MB (Ethernet), capture size 262144 bytes</span><br><span class="line">04:02:33.290867 IP 192.168.111.1.43848 &gt; webb.ssh: Flags [.], ack 3189235577, win 12881, options [nop,nop,TS val 558677448 ecr 2639240996], length 0</span><br><span class="line">04:02:33.290920 IP 192.168.111.1.43848 &gt; webb.ssh: Flags [.], ack 153, win 12881, options [nop,nop,TS val 558677448 ecr 2639240996], length 0</span><br><span class="line">04:02:33.291073 IP 192.168.111.1.43848 &gt; webb.ssh: Flags [.], ack 189, win 12881, options [nop,nop,TS val 558677449 ecr 2639240996], length 0</span><br><span class="line">3 packets captured</span><br><span class="line">12 packets received by filter</span><br><span class="line">0 packets dropped by kernel</span><br></pre></td></tr></table></figure>

<h3 id="greater-抓取数据包大于xx-bytes的数据包"><a href="#greater-抓取数据包大于xx-bytes的数据包" class="headerlink" title="greater 抓取数据包大于xx bytes的数据包"></a>greater 抓取数据包大于xx bytes的数据包</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">root@webb:~<span class="comment"># tcpdump greater 1000 -c 3</span></span><br><span class="line">tcpdump: verbose output suppressed, use -v or -vv <span class="keyword">for</span> full protocol decode</span><br><span class="line">listening on ens32, link-type EN10MB (Ethernet), capture size 262144 bytes</span><br><span class="line">04:04:02.375412 IP gw.gcableconfig.local.http &gt; webb.49690: Flags [P.], <span class="built_in">seq</span> 2285946385:2285949281, ack 3210337588, win 64240, length 2896: HTTP: HTTP/1.0 200 OK</span><br><span class="line">04:04:02.376102 IP webb.ssh &gt; 192.168.111.1.38728: Flags [P.], <span class="built_in">seq</span> 1635248512:1635251300, ack 1337887836, win 501, options [nop,nop,TS val 2639330081 ecr 558766503], length 2788</span><br><span class="line">04:04:02.380943 IP gw.gcableconfig.local.http &gt; webb.49690: Flags [FP.], <span class="built_in">seq</span> 2896:5302, ack 1, win 64240, length 2406: HTTP</span><br><span class="line">3 packets captured</span><br><span class="line">4 packets received by filter</span><br><span class="line">0 packets dropped by kernel</span><br></pre></td></tr></table></figure></div></article></div></main><footer><div class="paginator"><a class="prev" href="/2022/08/24/S2-easy-rce2-WriteUp/">prev</a><a class="next" href="/2022/06/30/vulntarget-h%20write-up/">next</a></div><div class="copyright"><p>&copy; 2022 <a href="http://webb-l.top">Webb</a><br>Powered by <a href="https://hexo.io/" rel="noreferrer" target="_blank">Hexo</a></p></div></footer></div></div><script src="https://cdnjs.cloudflare.com/ajax/libs/barba.js/1.0.0/barba.min.js"></script><script>document.addEventListener('DOMContentLoaded', function() {
    Barba.Pjax.start()
})</script></body></html>