<!DOCTYPE html><html lang="cn"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="robots" content="index, follow"><title>S2-你够快吗 WriteUp • Webb</title><meta name="description" content="S2-你够快吗 WriteUp - Webb"><link rel="icon" href="/57182600.jpeg"><link rel="stylesheet" href="https://unpkg.com/nanoreset@3.0.1/nanoreset.min.css"><link rel="stylesheet" href="/css/theme.css"><link rel="search" type="application/opensearchdescription+xml" href="/atom.xml" title="Webb"><meta name="generator" content="Hexo 6.2.0"><link rel="alternate" href="/atom.xml" title="Webb" type="application/atom+xml">
</head><body><div class="wrap" id="barba-wrapper"><header><h1 class="branding"><a href="/" title="Webb"><img class="logo-image" src="/57182600.jpeg" alt="logo"></a></h1><ul class="nav nav-list"><li class="nav-list-item"><a class="nav-list-link no-barba" href="/" target="_self">主页</a></li><li class="nav-list-item"><a class="nav-list-link no-barba" href="/about" target="_self">关于</a></li><li class="nav-list-item"><a class="nav-list-link no-barba" href="/works" target="_self">作品</a></li><li class="nav-list-item"><a class="nav-list-link no-barba" href="/archives" target="_self">档案</a></li><li class="nav-list-item"></ul></header><div class="barba-container"><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">S2-你够快吗 WriteUp</h1><div class="post-info"><a></a>2022-08-25</div><div class="post-content"><h2 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h2><ul>
<li>从下方的代码可以看出需要我们计算结果发送过去。</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>给你一秒你把握住<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;text-align: center;&quot;</span>&gt;</span>听说你<span class="tag">&lt;<span class="name">a</span> <span class="attr">style</span>=<span class="string">&quot;color: green&quot;</span>&gt;</span>单身了十八年<span class="tag">&lt;/<span class="name">a</span>&gt;</span>？<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;text-align: center;&quot;</span>&gt;</span>那你<span class="tag">&lt;<span class="name">a</span> <span class="attr">style</span>=<span class="string">&quot;color: blue&quot;</span>&gt;</span>肯定<span class="tag">&lt;/<span class="name">a</span>&gt;</span>能把这段文字复制下来发给我吧？<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;text-align: center;&quot;</span>&gt;</span>VZueaGo7<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;text-align: center;&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> <span class="attr">action</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;randomstring&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&#x27;冲了&#x27;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;text-align: center;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;text-align: center;&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;.&quot;</span>&gt;</span>我不服，再来<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">手速不够可以用工具：</span></span><br><span class="line"><span class="comment">import requests</span></span><br><span class="line"><span class="comment">import re</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h2><ul>
<li><p>尝试发送正确答案。</p>
</li>
<li><p>下方的结果不能正确响应应该是我们缺少参数，尝试加入Cookie。</p>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">┌──(kali㉿kali)-[~/桌面]</span><br><span class="line">└─$ curl -d <span class="string">&quot;randomstring=答案&quot;</span> <span class="string">&quot;http://你的靶机ID.ctf.nynusec.com/&quot;</span></span><br><span class="line">&lt;!DOCTYPE HTML PUBLIC <span class="string">&quot;-//W3C//DTD HTML 3.2 Final//EN&quot;</span>&gt;</span><br><span class="line">&lt;title&gt;500 Internal Server Error&lt;/title&gt;</span><br><span class="line">&lt;h1&gt;Internal Server Error&lt;/h1&gt;</span><br><span class="line">&lt;p&gt;The server encountered an internal error and was unable to complete your request. Either the server is overloaded or there is an error <span class="keyword">in</span> the application.&lt;/p&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li>获取Cookie。</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">┌──(kali㉿kali)-[~/桌面]</span><br><span class="line">└─$ curl -v <span class="string">&quot;http://你的靶机ID.ctf.nynusec.com/&quot;</span> </span><br><span class="line">...</span><br><span class="line">&lt; Set-Cookie: session=eyJjdGltZSI6MTY2MTM2MDAyNSwicmFuZG9tc3RyaW5nIjoib1VKclN4NzQifQ.YwZXmQ.F2Cg6ksvPrFSUJ4fB5A1azrQxVs; HttpOnly; Path=/</span><br><span class="line">...</span><br><span class="line">&lt;div style=<span class="string">&quot;text-align: center;&quot;</span>&gt;oUJrSx74&lt;/div&gt;</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<ul>
<li>提交正确答案。接下来应该需要使用Python。</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">┌──(kali㉿kali)-[~/桌面]</span><br><span class="line">└─$ curl -d <span class="string">&quot;randomstring=答案&quot;</span> -b <span class="string">&quot;session=eyJjdGltZSI6MTY2MTM2MDAyNSwicmFuZG9tc3RyaW5nIjoib1VKclN4NzQifQ.YwZXmQ.F2Cg6ksvPrFSUJ4fB5A1azrQxVs&quot;</span> <span class="string">&quot;http://你的靶机ID.ctf.nynusec.com/&quot;</span></span><br><span class="line">...</span><br><span class="line">&lt;div style=<span class="string">&quot;text-align: center;&quot;</span>&gt;就这速度还想拿到flag？&lt;/div&gt;</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<ul>
<li>编写Python代码。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://你的靶机ID.ctf.nynusec.com/&quot;</span></span><br><span class="line">// 请求靶机题目和Cookie。</span><br><span class="line">response = requests.get(url)</span><br><span class="line">// 使用正则匹配答案。</span><br><span class="line">answer = re.search(<span class="string">&quot;(\d|[a-z]|[A-Z])&#123;8&#125;&quot;</span>, response.text).group()</span><br><span class="line">// 将答案和Cookie发送到靶机。</span><br><span class="line">result = requests.post(</span><br><span class="line">    url,</span><br><span class="line">    data=&#123;</span><br><span class="line">        <span class="string">&quot;randomstring&quot;</span>: answer</span><br><span class="line">    &#125;,</span><br><span class="line">    headers=&#123;</span><br><span class="line">        <span class="string">&quot;Cookie&quot;</span>: <span class="string">&quot;session=&quot;</span> + response.cookies.get(<span class="string">&quot;session&quot;</span>),</span><br><span class="line">    &#125;</span><br><span class="line">)</span><br><span class="line">// 匹配flag</span><br><span class="line">flag = re.findall(<span class="string">&quot;(flag\&#123;.+\&#125;)&quot;</span>, result.text)[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<ul>
<li>运行脚本</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">┌──(kali㉿kali)-[~]</span><br><span class="line">└─$ python main.py </span><br><span class="line">flag&#123;4e293a2c-****-****-****-12dc79a1461b&#125;</span><br></pre></td></tr></table></figure>
</div></article></div></main><footer><div class="paginator"><a class="next" href="/2022/08/25/S2-%E7%AE%80%E5%8D%95%E7%9A%84PHP%E9%BB%91%E9%AD%94%E6%B3%95-WriteUp/">next</a></div><div class="copyright"><p>&copy; 2022 <a href="http://webb-l.top">Webb</a><br>Powered by <a href="https://hexo.io/" rel="noreferrer" target="_blank">Hexo</a></p></div></footer></div></div><script src="https://cdnjs.cloudflare.com/ajax/libs/barba.js/1.0.0/barba.min.js"></script><script>document.addEventListener('DOMContentLoaded', function() {
    Barba.Pjax.start()
})</script></body></html>